<!doctype html>
<html lang="en">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Vibrant Impact Ministries</title>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100%;
      color: #333;
    }

    html {
      height: 100%;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
    }

    header {
      background: rgba(255, 255, 255, 0.95);
      padding: 30px 20px;
      border-radius: 15px;
      text-align: center;
      margin-bottom: 30px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
      position: relative;
    }

    h1 {
      color: #667eea;
      font-size: 2.5em;
      margin-bottom: 10px;
    }

    .tagline {
      color: #666;
      font-size: 1.2em;
      font-style: italic;
    }

    .user-info {
      position: absolute;
      top: 20px;
      right: 20px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 10px 20px;
      border-radius: 25px;
      font-size: 0.9em;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .user-info .badge {
      background: rgba(255, 255, 255, 0.3);
      padding: 4px 10px;
      border-radius: 12px;
      font-size: 0.85em;
      font-weight: 600;
    }

    .logout-btn {
      background: rgba(255, 255, 255, 0.2);
      border: 1px solid white;
      color: white;
      padding: 6px 15px;
      border-radius: 15px;
      cursor: pointer;
      font-size: 0.9em;
      transition: background 0.3s;
    }

    .logout-btn:hover {
      background: rgba(255, 255, 255, 0.3);
    }

    nav {
      background: rgba(255, 255, 255, 0.95);
      padding: 15px;
      border-radius: 10px;
      margin-bottom: 30px;
      box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
    }

    nav ul {
      list-style: none;
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 10px;
    }

    nav button {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      padding: 12px 25px;
      border-radius: 25px;
      cursor: pointer;
      font-size: 1em;
      font-weight: 600;
      transition: transform 0.2s, box-shadow 0.2s;
    }

    nav button:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
    }

    nav button.active {
      background: linear-gradient(135deg, #764ba2 0%, #667eea 100%);
      box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
    }

    .section {
      display: none;
      background: rgba(255, 255, 255, 0.95);
      padding: 30px;
      border-radius: 15px;
      margin-bottom: 20px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
    }

    .section.active {
      display: block;
      animation: fadeIn 0.5s;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    h2 {
      color: #667eea;
      margin-bottom: 20px;
      font-size: 2em;
      border-bottom: 3px solid #764ba2;
      padding-bottom: 10px;
    }

    .gallery-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 25px;
      margin-top: 30px;
    }

    .gallery-item {
      background: white;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
      transition: transform 0.3s, box-shadow 0.3s;
    }

    .gallery-item:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
    }

    .gallery-item img {
      width: 100%;
      height: 250px;
      object-fit: cover;
    }

    .gallery-item-content {
      padding: 20px;
    }

    .gallery-item h3 {
      color: #667eea;
      margin-bottom: 10px;
      font-size: 1.3em;
    }

    .gallery-item p {
      color: #666;
      line-height: 1.6;
      margin-bottom: 10px;
    }

    .gallery-item .date {
      color: #999;
      font-size: 0.9em;
      font-style: italic;
    }

    .video-container {
      position: relative;
      padding-bottom: 56.25%;
      height: 0;
      overflow: hidden;
      border-radius: 12px;
      margin-bottom: 15px;
    }

    .video-container iframe {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
    }

    .auth-container {
      max-width: 500px;
      margin: 0 auto;
      background: rgba(255, 255, 255, 0.95);
      padding: 40px;
      border-radius: 15px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
    }

    .auth-tabs {
      display: flex;
      gap: 10px;
      margin-bottom: 30px;
    }

    .auth-tab {
      flex: 1;
      padding: 12px;
      background: #f0f0f0;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 1em;
      font-weight: 600;
      transition: all 0.3s;
    }

    .auth-tab.active {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
    }

    .auth-form {
      display: none;
    }

    .auth-form.active {
      display: block;
    }

    .upload-form {
      background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
      padding: 30px;
      border-radius: 12px;
      margin-bottom: 30px;
    }

    .form-group {
      margin-bottom: 20px;
    }

    label {
      display: block;
      margin-bottom: 8px;
      color: #333;
      font-weight: 600;
    }

    input[type="text"],
    input[type="email"],
    input[type="password"],
    input[type="date"],
    textarea,
    select {
      width: 100%;
      padding: 12px;
      border: 2px solid #ddd;
      border-radius: 8px;
      font-size: 1em;
      transition: border-color 0.3s;
    }

    input[type="text"]:focus,
    input[type="email"]:focus,
    input[type="password"]:focus,
    input[type="date"]:focus,
    textarea:focus,
    select:focus {
      outline: none;
      border-color: #667eea;
    }

    textarea {
      min-height: 100px;
      resize: vertical;
    }

    .button-group {
      display: flex;
      gap: 15px;
      margin-top: 25px;
    }

    button[type="submit"] {
      flex: 1;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      padding: 15px 30px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 1.1em;
      font-weight: 600;
      transition: transform 0.2s, box-shadow 0.2s;
    }

    button[type="submit"]:hover:not(:disabled) {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
    }

    button[type="submit"]:disabled {
      opacity: 0.6;
      cursor: not-allowed;
    }

    .delete-btn {
      background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
      color: white;
      border: none;
      padding: 8px 16px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 0.9em;
      margin-top: 10px;
      transition: transform 0.2s;
    }

    .delete-btn:hover {
      transform: scale(1.05);
    }

    .toast {
      position: fixed;
      bottom: 30px;
      right: 30px;
      background: #333;
      color: white;
      padding: 16px 24px;
      border-radius: 8px;
      box-shadow: 0 4px 16px rgba(0, 0, 0, 0.3);
      z-index: 1000;
      animation: slideIn 0.3s;
    }

    .toast.success {
      background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
    }

    .toast.error {
      background: linear-gradient(135deg, #eb3349 0%, #f45c43 100%);
    }

    @keyframes slideIn {
      from {
        transform: translateX(400px);
        opacity: 0;
      }
      to {
        transform: translateX(0);
        opacity: 1;
      }
    }

    .spinner {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 3px solid rgba(255, 255, 255, 0.3);
      border-radius: 50%;
      border-top-color: white;
      animation: spin 0.8s linear infinite;
      margin-left: 10px;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    .setup-instructions {
      background: #fff3cd;
      border: 2px solid #ffc107;
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 20px;
    }

    .setup-instructions h3 {
      color: #856404;
      margin-bottom: 10px;
    }

    .setup-instructions ol {
      margin-left: 20px;
      color: #856404;
    }

    .setup-instructions li {
      margin-bottom: 8px;
      line-height: 1.6;
    }

    .setup-instructions code {
      background: #f8f9fa;
      padding: 2px 6px;
      border-radius: 4px;
      font-family: monospace;
    }

    .access-denied {
      text-align: center;
      padding: 40px;
      color: #666;
    }

    .access-denied h3 {
      color: #f5576c;
      margin-bottom: 15px;
    }

    @media (max-width: 768px) {
      h1 {
        font-size: 2em;
      }

      .user-info {
        position: static;
        margin-top: 15px;
        justify-content: center;
      }

      .gallery-grid {
        grid-template-columns: 1fr;
      }

      nav ul {
        flex-direction: column;
      }

      nav button {
        width: 100%;
      }

      .button-group {
        flex-direction: column;
      }

      .auth-container {
        padding: 20px;
      }
    }
  </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
  <script src="/_sdk/element_sdk.js" type="text/javascript"></script>
  <script src="https://cdn.tailwindcss.com" type="text/javascript"></script>
 </head>
 <body>
  <div id="authPage" class="container">
   <div class="auth-container">
    <h1 style="text-align: center; margin-bottom: 30px;">üôè Vibrant Impact Ministries</h1>
    <div class="setup-instructions" id="setupInstructions">
     <h3>üî• Firebase Setup Required</h3>
     <ol>
      <li>Go to <a href="https://console.firebase.google.com" target="_blank">Firebase Console</a></li>
      <li>Create a new project</li>
      <li>Enable <strong>Email/Password</strong> authentication (Authentication ‚Üí Sign-in method)</li>
      <li>Enable <strong>Firestore Database</strong> (Start in test mode)</li>
      <li>Get your web app config and replace in the code</li>
      <li><strong>IMPORTANT:</strong> Create admin accounts using the Admin Login form below with: <code>eiweh123@gmail.com</code> or <code>vibrantchannel286@gmail.com</code></li>
     </ol>
    </div>
    <div class="auth-tabs"><button class="auth-tab active" onclick="switchAuthTab('member')">üë• Member Sign Up</button> <button class="auth-tab" onclick="switchAuthTab('admin')">üîê Admin Login</button>
    </div>
    <form id="memberSignupForm" class="auth-form active">
     <h2 style="font-size: 1.5em; margin-bottom: 20px;">Join Our Church Family</h2>
     <div class="form-group"><label for="memberName">Full Name:</label> <input type="text" id="memberName" required>
     </div>
     <div class="form-group"><label for="memberEmail">Email:</label> <input type="email" id="memberEmail" required>
     </div>
     <div class="form-group"><label for="memberPassword">Password:</label> <input type="password" id="memberPassword" minlength="6" required>
     </div><button type="submit">Sign Up as Member</button>
    </form>
    <form id="adminLoginForm" class="auth-form">
     <h2 style="font-size: 1.5em; margin-bottom: 20px;">Admin Access</h2>
     <div class="form-group"><label for="adminEmail">Admin Email:</label> <input type="email" id="adminEmail" required>
     </div>
     <div class="form-group"><label for="adminPassword">Password:</label> <input type="password" id="adminPassword" required>
     </div><button type="submit">Login as Admin</button>
     <p style="margin-top: 15px; font-size: 0.9em; color: #666; text-align: center;">First time? Create admin account with:<br><strong>eiweh123@gmail.com</strong> or <strong>vibrantchannel286@gmail.com</strong></p>
    </form>
   </div>
  </div>
  <div id="mainPage" class="container" style="display: none;">
   <header>
    <h1>üôè Vibrant Impact Ministries</h1>
    <p class="tagline">Building Faith, Inspiring Lives</p>
    <div class="user-info" id="userInfo"></div>
   </header>
   <nav>
    <ul id="navMenu">
     <li><button class="nav-btn active" data-section="photos">üì∏ Photo Gallery</button></li>
     <li><button class="nav-btn" data-section="videos">üé• Video Gallery</button></li>
     <li><button class="nav-btn" data-section="partners">ü§ù Become a Partner</button></li>
    </ul>
   </nav>
   <section id="photos" class="section active">
    <h2>üì∏ Photo Gallery</h2>
    <div class="gallery-grid" id="photoGallery"><!-- Photos will be loaded here -->
    </div>
   </section>
   <section id="videos" class="section">
    <h2>üé• Video Gallery</h2>
    <div class="gallery-grid" id="videoGallery"><!-- Videos will be loaded here -->
    </div>
   </section>
   <section id="partners" class="section">
    <h2>ü§ù Become a Ministry Partner</h2><!-- WhatsApp Group Section -->
    <div style="background: linear-gradient(135deg, #25D366 0%, #128C7E 100%); padding: 30px; border-radius: 12px; margin-bottom: 30px; color: white; text-align: center;">
     <h3 style="font-size: 1.8em; margin-bottom: 15px; color: white;">üí¨ Join Our WhatsApp Community</h3>
     <p style="font-size: 1.1em; line-height: 1.6; margin-bottom: 20px; opacity: 0.95;">Stay connected with our church family! Get instant updates on services, events, prayer requests, and daily devotionals.</p><a href="https://chat.whatsapp.com/YOUR_GROUP_INVITE_CODE" target="_blank" rel="noopener noreferrer" style="display: inline-block; background: white; color: #25D366; padding: 15px 40px; border-radius: 50px; text-decoration: none; font-size: 1.2em; font-weight: 700; transition: transform 0.3s, box-shadow 0.3s; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);" onmouseover="this.style.transform='scale(1.05)'; this.style.boxShadow='0 6px 25px rgba(0, 0, 0, 0.3)'" onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='0 4px 15px rgba(0, 0, 0, 0.2)'"> üì± Join WhatsApp Group </a>
     <p style="font-size: 0.9em; margin-top: 15px; opacity: 0.9;">Click the button above to join our vibrant community of believers</p>
    </div>
    <div style="background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); padding: 30px; border-radius: 12px; margin-bottom: 30px;">
     <p style="font-size: 1.1em; line-height: 1.8; color: #333; margin-bottom: 20px;">Join us in making a difference! As a ministry partner, you'll support our mission to build faith and inspire lives in our community. Your partnership helps us continue our work in worship services, youth programs, and community outreach.</p>
     <div style="background: white; padding: 20px; border-radius: 8px; margin-bottom: 25px;">
      <h3 style="color: #667eea; margin-bottom: 15px;">Partnership Benefits:</h3>
      <ul style="color: #666; line-height: 2; margin-left: 20px;">
       <li>Monthly ministry updates and prayer requests</li>
       <li>Exclusive access to ministry events</li>
       <li>Recognition in our annual report</li>
       <li>Be part of transforming lives in our community</li>
      </ul>
     </div>
     <form id="partnerForm">
      <h3 style="margin-bottom: 20px; color: #667eea;">Partner Registration</h3>
      <div class="form-group"><label for="partnerName">Full Name: *</label> <input type="text" id="partnerName" required>
      </div>
      <div class="form-group"><label for="partnerEmail">Email Address: *</label> <input type="email" id="partnerEmail" required>
      </div>
      <div class="form-group"><label for="partnerPhone">Phone Number:</label> <input type="text" id="partnerPhone" placeholder="(optional)">
      </div>
      <div class="form-group"><label for="partnerAddress">Address:</label> <input type="text" id="partnerAddress" placeholder="Street Address (optional)">
      </div>
      <div class="form-group"><label for="partnerCity">City:</label> <input type="text" id="partnerCity" placeholder="(optional)">
      </div>
      <div class="form-group"><label for="partnershipType">Partnership Type: *</label> <select id="partnershipType" required> <option value="">-- Select Partnership Type --</option> <option value="monthly-financial">Monthly Financial Support</option> <option value="one-time-financial">One-Time Financial Gift</option> <option value="prayer-partner">Prayer Partner</option> <option value="volunteer">Volunteer Service</option> <option value="combined">Combined (Financial + Volunteer)</option> </select>
      </div>
      <div class="form-group"><label for="partnerMessage">Message / Prayer Requests:</label> <textarea id="partnerMessage" placeholder="Share your heart with us... Why do you want to partner with us? Any specific prayer requests?"></textarea>
      </div>
      <div class="form-group"><label style="display: flex; align-items: center; gap: 10px; cursor: pointer;"> <input type="checkbox" id="partnerConsent" required style="width: auto; cursor: pointer;"> <span>I agree to receive ministry updates and communications *</span> </label>
      </div><button type="submit" id="partnerSubmitBtn"> ü§ù Submit Partnership Application </button>
      <p style="margin-top: 15px; font-size: 0.9em; color: #666; text-align: center;">After submitting, our team will contact you within 2-3 business days.</p>
     </form>
    </div>
   </section>
   <section id="upload" class="section">
    <h2>‚¨ÜÔ∏è Upload Media</h2>
    <div id="adminOnly">
     <div class="upload-form">
      <h3>Add Photo or Video</h3>
      <form id="mediaForm">
       <div class="form-group"><label for="mediaType">Media Type:</label> <select id="mediaType" required> <option value="">-- Select Type --</option> <option value="photo">Photo (Image URL)</option> <option value="video">Video (YouTube/Facebook URL)</option> </select>
       </div>
       <div class="form-group"><label for="category">Category:</label> <select id="category" required> <option value="">-- Select Category --</option> <option value="sunday-service">Sunday Service</option> <option value="youth-ministry">Youth Ministry</option> <option value="community-outreach">Community Outreach</option> <option value="special-events">Special Events</option> </select>
       </div>
       <div class="form-group"><label for="mediaUrl">Image URL or Video URL:</label> <input type="text" id="mediaUrl" placeholder="Paste Imgur, ImgBB, YouTube, or Facebook link" required> <small style="color: #666; margin-top: 5px; display: block;"> For photos: Upload to <a href="https://imgur.com" target="_blank">Imgur</a> or <a href="https://imgbb.com" target="_blank">ImgBB</a>, then paste the direct image URL here </small>
       </div>
       <div class="form-group"><label for="eventName">Event Name:</label> <input type="text" id="eventName" placeholder="e.g., Sunday Worship Service" required>
       </div>
       <div class="form-group"><label for="description">Description:</label> <textarea id="description" placeholder="Tell us about this moment..."></textarea>
       </div>
       <div class="form-group"><label for="eventDate">Event Date:</label> <input type="date" id="eventDate" required>
       </div>
       <div class="button-group"><button type="submit" id="submitBtn">Upload Media</button>
       </div>
      </form>
     </div>
    </div>
    <div id="memberOnly" style="display: none;">
     <div class="access-denied">
      <h3>üîí Admin Access Required</h3>
      <p>Only administrators can upload media. Please contact your church admin if you need to upload content.</p>
     </div>
    </div>
   </section>
   <section id="partner-list" class="section">
    <h2>üë• Partnership Applications</h2>
    <p style="color: #666; margin-bottom: 20px;">Review and manage partnership applications</p>
    <div id="partnerApplications" class="gallery-grid"><!-- Partner applications will be loaded here -->
    </div>
   </section>
  </div>
  <script>
    // ÔøΩÔøΩÔøΩÔ∏è REPLACE WITH YOUR FIREBASE CONFIG
    const firebaseConfig = {
      apiKey: "YOUR_API_KEY",
      authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
      projectId: "YOUR_PROJECT_ID",
      storageBucket: "YOUR_PROJECT_ID.appspot.com",
      messagingSenderId: "YOUR_MESSAGING_SENDER_ID",
      appId: "YOUR_APP_ID"
    };

    // Initialize Firebase
    let db;
    let auth;
    let isFirebaseConfigured = false;
    let currentUser = null;
    let isAdmin = false;

    // Admin emails - only these emails have admin privileges
    const ADMIN_EMAILS = [
      "eiweh123@gmail.com",
      "vibrantchannel286@gmail.com"
    ];

    try {
      if (firebaseConfig.apiKey !== "YOUR_API_KEY") {
        firebase.initializeApp(firebaseConfig);
        db = firebase.firestore();
        auth = firebase.auth();
        isFirebaseConfigured = true;
        document.getElementById('setupInstructions').style.display = 'none';

        // Check auth state
        auth.onAuthStateChanged((user) => {
          if (user) {
            currentUser = user;
            isAdmin = ADMIN_EMAILS.includes(user.email);
            showMainPage();
          } else {
            currentUser = null;
            isAdmin = false;
            showAuthPage();
          }
        });
      }
    } catch (error) {
      console.error('Firebase initialization error:', error);
    }

    // Switch auth tabs
    function switchAuthTab(type) {
      const tabs = document.querySelectorAll('.auth-tab');
      const forms = document.querySelectorAll('.auth-form');
      
      tabs.forEach(tab => tab.classList.remove('active'));
      forms.forEach(form => form.classList.remove('active'));
      
      if (type === 'member') {
        tabs[0].classList.add('active');
        document.getElementById('memberSignupForm').classList.add('active');
      } else {
        tabs[1].classList.add('active');
        document.getElementById('adminLoginForm').classList.add('active');
      }
    }

    // Show auth page
    function showAuthPage() {
      document.getElementById('authPage').style.display = 'block';
      document.getElementById('mainPage').style.display = 'none';
    }

    // Show main page
    function showMainPage() {
      document.getElementById('authPage').style.display = 'none';
      document.getElementById('mainPage').style.display = 'block';
      
      // Update user info
      const userInfo = document.getElementById('userInfo');
      userInfo.innerHTML = `
        <span>${currentUser.email}</span>
        <span class="badge">${isAdmin ? 'üëë ADMIN' : 'üë• MEMBER'}</span>
        <button class="logout-btn" onclick="logout()">Logout</button>
      `;

      // Show/hide upload section based on role
      const navMenu = document.getElementById('navMenu');
      const uploadNavItem = navMenu.querySelector('[data-section="upload"]');
      const partnerListNavItem = navMenu.querySelector('[data-section="partner-list"]');
      
      if (isAdmin) {
        if (!uploadNavItem) {
          const li = document.createElement('li');
          li.innerHTML = '<button class="nav-btn" data-section="upload">‚¨ÜÔ∏è Upload Media</button>';
          navMenu.appendChild(li);
          li.querySelector('button').addEventListener('click', function() {
            switchSection('upload');
          });
        }
        if (!partnerListNavItem) {
          const li = document.createElement('li');
          li.innerHTML = '<button class="nav-btn" data-section="partner-list">üë• Partner Applications</button>';
          navMenu.appendChild(li);
          li.querySelector('button').addEventListener('click', function() {
            switchSection('partner-list');
            loadPartnerApplications();
          });
        }
        document.getElementById('adminOnly').style.display = 'block';
        document.getElementById('memberOnly').style.display = 'none';
      } else {
        if (uploadNavItem) {
          uploadNavItem.remove();
        }
        if (partnerListNavItem) {
          partnerListNavItem.remove();
        }
      }

      loadMedia();
      setupNavigation();
    }

    // Member signup
    document.getElementById('memberSignupForm').addEventListener('submit', async (e) => {
      e.preventDefault();
      
      if (!isFirebaseConfigured) {
        showToast('Please configure Firebase first!', 'error');
        return;
      }

      const name = document.getElementById('memberName').value;
      const email = document.getElementById('memberEmail').value;
      const password = document.getElementById('memberPassword').value;

      try {
        const userCredential = await auth.createUserWithEmailAndPassword(email, password);
        
        // Save member info to Firestore
        await db.collection('members').doc(userCredential.user.uid).set({
          name: name,
          email: email,
          role: 'member',
          joinedAt: firebase.firestore.FieldValue.serverTimestamp()
        });

        showToast('Welcome to Vibrant Impact Ministries! ÔøΩÔøΩ', 'success');
      } catch (error) {
        console.error('Signup error:', error);
        showToast('Signup failed: ' + error.message, 'error');
      }
    });

    // Admin login
    document.getElementById('adminLoginForm').addEventListener('submit', async (e) => {
      e.preventDefault();
      
      if (!isFirebaseConfigured) {
        showToast('Please configure Firebase first!', 'error');
        return;
      }

      const email = document.getElementById('adminEmail').value;
      const password = document.getElementById('adminPassword').value;

      try {
        await auth.createUserWithEmailAndPassword(email, password);
        showToast('Admin account created! You can now login.', 'success');
      } catch (error) {
        if (error.code === 'auth/email-already-in-use') {
          try {
            await auth.signInWithEmailAndPassword(email, password);
            if (ADMIN_EMAILS.includes(email)) {
              showToast('Welcome back, Admin! üëë', 'success');
            } else {
              showToast('This email is not authorized as admin.', 'error');
              auth.signOut();
            }
          } catch (loginError) {
            showToast('Login failed: ' + loginError.message, 'error');
          }
        } else {
          showToast('Error: ' + error.message, 'error');
        }
      }
    });

    // Logout
    async function logout() {
      try {
        await auth.signOut();
        showToast('Logged out successfully', 'success');
      } catch (error) {
        showToast('Logout failed: ' + error.message, 'error');
      }
    }

    // Navigation
    function setupNavigation() {
      const navButtons = document.querySelectorAll('.nav-btn');
      navButtons.forEach(button => {
        button.addEventListener('click', () => {
          switchSection(button.dataset.section);
        });
      });
    }

    function switchSection(sectionName) {
      const navButtons = document.querySelectorAll('.nav-btn');
      const sections = document.querySelectorAll('.section');
      
      navButtons.forEach(btn => btn.classList.remove('active'));
      sections.forEach(section => section.classList.remove('active'));
      
      const activeButton = document.querySelector(`[data-section="${sectionName}"]`);
      if (activeButton) activeButton.classList.add('active');
      
      const activeSection = document.getElementById(sectionName);
      if (activeSection) activeSection.classList.add('active');
    }

    // Toast notification
    function showToast(message, type = 'success') {
      const toast = document.createElement('div');
      toast.className = `toast ${type}`;
      toast.textContent = message;
      document.body.appendChild(toast);
      
      setTimeout(() => {
        toast.remove();
      }, 4000);
    }

    // Convert YouTube URL to embed URL
    function getYouTubeEmbedUrl(url) {
      const regExp = /^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|&v=)([^#&?]*).*/;
      const match = url.match(regExp);
      return (match && match[2].length === 11) ? `https://www.youtube.com/embed/${match[2]}` : null;
    }

    // Convert Facebook video URL to embed URL
    function getFacebookEmbedUrl(url) {
      return `https://www.facebook.com/plugins/video.php?href=${encodeURIComponent(url)}&show_text=false`;
    }

    // Load media from Firestore
    async function loadMedia() {
      if (!isFirebaseConfigured) return;

      try {
        // Load photos
        const photosSnapshot = await db.collection('photos').orderBy('timestamp', 'desc').get();
        const photoGallery = document.getElementById('photoGallery');
        photoGallery.innerHTML = '';

        if (photosSnapshot.empty) {
          photoGallery.innerHTML = '<p style="color: #666; text-align: center; grid-column: 1/-1;">No photos yet. Upload your first photo!</p>';
        } else {
          photosSnapshot.forEach(doc => {
            const data = doc.data();
            photoGallery.appendChild(createPhotoCard(doc.id, data));
          });
        }

        // Load videos
        const videosSnapshot = await db.collection('videos').orderBy('timestamp', 'desc').get();
        const videoGallery = document.getElementById('videoGallery');
        videoGallery.innerHTML = '';

        if (videosSnapshot.empty) {
          videoGallery.innerHTML = '<p style="color: #666; text-align: center; grid-column: 1/-1;">No videos yet. Upload your first video!</p>';
        } else {
          videosSnapshot.forEach(doc => {
            const data = doc.data();
            videoGallery.appendChild(createVideoCard(doc.id, data));
          });
        }
      } catch (error) {
        console.error('Error loading media:', error);
        showToast('Error loading media: ' + error.message, 'error');
      }
    }

    // Create photo card
    function createPhotoCard(id, data) {
      const card = document.createElement('div');
      card.className = 'gallery-item';
      
      const deleteButton = isAdmin ? `<button class="delete-btn" onclick="deleteMedia('photos', '${id}')">üóëÔ∏è Delete</button>` : '';
      const downloadButton = `<button class="delete-btn" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);" onclick="downloadImage('${data.url}', '${data.eventName}')">‚¨áÔ∏è Download</button>`;
      
      card.innerHTML = `
        <img src="${data.url}" alt="${data.eventName}" onerror="this.src=''; this.alt='Image failed to load'; this.style.display='none';">
        <div class="gallery-item-content">
          <h3>${data.eventName}</h3>
          <p>${data.description || 'No description'}</p>
          <p class="date">üìÖ ${data.eventDate}</p>
          <p class="date" style="margin-top: 5px;">üè∑Ô∏è ${data.category.replace('-', ' ').replace(/\b\w/g, l => l.toUpperCase())}</p>
          <div style="display: flex; gap: 10px; margin-top: 10px;">
            ${downloadButton}
            ${deleteButton}
          </div>
        </div>
      `;
      
      return card;
    }

    // Create video card
    function createVideoCard(id, data) {
      const card = document.createElement('div');
      card.className = 'gallery-item';
      
      let embedUrl;
      if (data.url.includes('youtube.com') || data.url.includes('youtu.be')) {
        embedUrl = getYouTubeEmbedUrl(data.url);
      } else if (data.url.includes('facebook.com')) {
        embedUrl = getFacebookEmbedUrl(data.url);
      }
      
      const deleteButton = isAdmin ? `<button class="delete-btn" onclick="deleteMedia('videos', '${id}')">üóëÔ∏è Delete</button>` : '';
      
      card.innerHTML = `
        <div class="video-container">
          <iframe src="${embedUrl}" frameborder="0" allowfullscreen></iframe>
        </div>
        <div class="gallery-item-content">
          <h3>${data.eventName}</h3>
          <p>${data.description || 'No description'}</p>
          <p class="date">üìÖ ${data.eventDate}</p>
          <p class="date" style="margin-top: 5px;">üè∑Ô∏è ${data.category.replace('-', ' ').replace(/\b\w/g, l => l.toUpperCase())}</p>
          ${deleteButton}
        </div>
      `;
      
      return card;
    }

    // Download image function
    async function downloadImage(url, eventName) {
      try {
        showToast('Downloading image...', 'success');
        
        // Fetch the image
        const response = await fetch(url);
        const blob = await response.blob();
        
        // Create download link
        const downloadUrl = window.URL.createObjectURL(blob);
        const link = document.createElement('a');
        link.href = downloadUrl;
        link.download = `${eventName.replace(/[^a-z0-9]/gi, '_')}.jpg`;
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
        
        // Clean up
        window.URL.revokeObjectURL(downloadUrl);
        showToast('Image downloaded successfully! üì•', 'success');
      } catch (error) {
        console.error('Download error:', error);
        showToast('Download failed. Try right-clicking and "Save image as..."', 'error');
      }
    }

    // Delete media (admin only)
    async function deleteMedia(collection, id) {
      if (!isAdmin) {
        showToast('Only admins can delete media', 'error');
        return;
      }

      if (!confirm('Are you sure you want to delete this item?')) return;

      try {
        await db.collection(collection).doc(id).delete();
        showToast('Media deleted successfully!', 'success');
        loadMedia();
      } catch (error) {
        console.error('Error deleting media:', error);
        showToast('Error deleting media: ' + error.message, 'error');
      }
    }

    // Partner form submission
    document.getElementById('partnerForm').addEventListener('submit', async (e) => {
      e.preventDefault();

      if (!isFirebaseConfigured) {
        showToast('Please configure Firebase first!', 'error');
        return;
      }

      const submitBtn = document.getElementById('partnerSubmitBtn');
      const originalText = submitBtn.innerHTML;
      submitBtn.disabled = true;
      submitBtn.innerHTML = 'Submitting<span class="spinner"></span>';

      try {
        const partnerData = {
          name: document.getElementById('partnerName').value,
          email: document.getElementById('partnerEmail').value,
          phone: document.getElementById('partnerPhone').value || 'Not provided',
          address: document.getElementById('partnerAddress').value || 'Not provided',
          city: document.getElementById('partnerCity').value || 'Not provided',
          partnershipType: document.getElementById('partnershipType').value,
          message: document.getElementById('partnerMessage').value || 'No message',
          consent: document.getElementById('partnerConsent').checked,
          status: 'pending',
          submittedAt: firebase.firestore.FieldValue.serverTimestamp(),
          submittedBy: currentUser ? currentUser.email : 'guest'
        };

        await db.collection('partners').add(partnerData);

        showToast('üéâ Thank you for your partnership application! We\'ll contact you soon.', 'success');
        document.getElementById('partnerForm').reset();

        // If admin, reload partner list
        if (isAdmin) {
          loadPartnerApplications();
        }

      } catch (error) {
        console.error('Partnership submission error:', error);
        showToast('Submission failed: ' + error.message, 'error');
      } finally {
        submitBtn.disabled = false;
        submitBtn.innerHTML = originalText;
      }
    });

    // Load partner applications (admin only)
    async function loadPartnerApplications() {
      if (!isFirebaseConfigured || !isAdmin) return;

      try {
        const partnersSnapshot = await db.collection('partners').orderBy('submittedAt', 'desc').get();
        const partnerApplications = document.getElementById('partnerApplications');
        partnerApplications.innerHTML = '';

        if (partnersSnapshot.empty) {
          partnerApplications.innerHTML = '<p style="color: #666; text-align: center; grid-column: 1/-1;">No partnership applications yet.</p>';
        } else {
          partnersSnapshot.forEach(doc => {
            const data = doc.data();
            partnerApplications.appendChild(createPartnerCard(doc.id, data));
          });
        }
      } catch (error) {
        console.error('Error loading partners:', error);
        showToast('Error loading applications: ' + error.message, 'error');
      }
    }

    // Create partner application card
    function createPartnerCard(id, data) {
      const card = document.createElement('div');
      card.className = 'gallery-item';
      
      const statusColor = data.status === 'pending' ? '#ffc107' : data.status === 'approved' ? '#38ef7d' : '#f5576c';
      const submittedDate = data.submittedAt ? new Date(data.submittedAt.toDate()).toLocaleDateString() : 'Unknown';
      
      card.innerHTML = `
        <div class="gallery-item-content">
          <h3>${data.name}</h3>
          <p><strong>üìß Email:</strong> ${data.email}</p>
          <p><strong>üì± Phone:</strong> ${data.phone}</p>
          <p><strong>üìç Location:</strong> ${data.city}</p>
          <p><strong>ü§ù Partnership Type:</strong> ${data.partnershipType.replace(/-/g, ' ').replace(/\b\w/g, l => l.toUpperCase())}</p>
          <p><strong>üí¨ Message:</strong> ${data.message}</p>
          <p class="date">üìÖ Submitted: ${submittedDate}</p>
          <p class="date" style="margin-top: 5px; color: ${statusColor};">
            <strong>Status:</strong> ${data.status.toUpperCase()}
          </p>
          <div style="display: flex; gap: 10px; margin-top: 15px;">
            ${data.status === 'pending' ? `
              <button class="delete-btn" style="background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%); flex: 1;" onclick="updatePartnerStatus('${id}', 'approved')">‚úÖ Approve</button>
              <button class="delete-btn" style="flex: 1;" onclick="updatePartnerStatus('${id}', 'rejected')">‚ùå Reject</button>
            ` : ''}
            <button class="delete-btn" style="flex: 1;" onclick="deletePartner('${id}')">üóëÔ∏è Delete</button>
          </div>
        </div>
      `;
      
      return card;
    }

    // Update partner status (admin only)
    async function updatePartnerStatus(id, status) {
      if (!isAdmin) {
        showToast('Only admins can update partner status', 'error');
        return;
      }

      try {
        await db.collection('partners').doc(id).update({
          status: status,
          updatedAt: firebase.firestore.FieldValue.serverTimestamp(),
          updatedBy: currentUser.email
        });

        showToast(`Partnership application ${status}!`, 'success');
        loadPartnerApplications();
      } catch (error) {
        console.error('Error updating partner status:', error);
        showToast('Error updating status: ' + error.message, 'error');
      }
    }

    // Delete partner application (admin only)
    async function deletePartner(id) {
      if (!isAdmin) {
        showToast('Only admins can delete applications', 'error');
        return;
      }

      if (!confirm('Are you sure you want to delete this partnership application?')) return;

      try {
        await db.collection('partners').doc(id).delete();
        showToast('Application deleted successfully!', 'success');
        loadPartnerApplications();
      } catch (error) {
        console.error('Error deleting partner:', error);
        showToast('Error deleting application: ' + error.message, 'error');
      }
    }

    // Form submission (admin only)
    document.getElementById('mediaForm').addEventListener('submit', async (e) => {
      e.preventDefault();

      if (!isAdmin) {
        showToast('Only admins can upload media', 'error');
        return;
      }

      if (!isFirebaseConfigured) {
        showToast('Please configure Firebase first!', 'error');
        return;
      }

      const submitBtn = document.getElementById('submitBtn');
      const originalText = submitBtn.innerHTML;
      submitBtn.disabled = true;
      submitBtn.innerHTML = 'Uploading<span class="spinner"></span>';

      const mediaType = document.getElementById('mediaType').value;
      const category = document.getElementById('category').value;
      const mediaUrl = document.getElementById('mediaUrl').value;
      const eventName = document.getElementById('eventName').value;
      const description = document.getElementById('description').value;
      const eventDate = document.getElementById('eventDate').value;

      try {
        const mediaData = {
          url: mediaUrl,
          category: category,
          eventName: eventName,
          description: description,
          eventDate: eventDate,
          uploadedBy: currentUser.email,
          timestamp: firebase.firestore.FieldValue.serverTimestamp()
        };

        if (mediaType === 'photo') {
          await db.collection('photos').add(mediaData);
        } else {
          await db.collection('videos').add(mediaData);
        }

        showToast(`${mediaType === 'photo' ? 'Photo' : 'Video'} uploaded successfully!`, 'success');
        document.getElementById('mediaForm').reset();
        loadMedia();

        // Switch to appropriate gallery
        switchSection(mediaType === 'photo' ? 'photos' : 'videos');

      } catch (error) {
        console.error('Upload error:', error);
        showToast('Upload failed: ' + error.message, 'error');
      } finally {
        submitBtn.disabled = false;
        submitBtn.innerHTML = originalText;
      }
    });
  </script>// For Firebase JS SDK v7.20.0 and later, measurementId is optional
const firebaseConfig = {
  apiKey: "AIzaSyBYwJ4PjGyycAzUS7iyTrTRpIUcKLAvPVE",
  authDomain: "vim-p-cc4be.firebaseapp.com",
  projectId: "vim-p-cc4be",
  storageBucket: "vim-p-cc4be.firebasestorage.app",
  messagingSenderId: "444991156114",
  appId: "1:444991156114:web:a6c5425cf3a9aa91369b4b",
  measurementId: "G-V0BVRB9WRR"
};
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9a5318e4a20506cf',t:'MTc2NDI2MTk0MC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
