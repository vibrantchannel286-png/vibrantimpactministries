<!doctype html>
<html lang="en">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Vibrant Impact Ministries - VIM</title>
  <style>
    body {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #1a2332 0%, #2d3e50 100%);
      color: #333;
      height: 100%;
    }

    * {
      box-sizing: border-box;
    }

    html {
      height: 100%;
    }

    /* Header */
    header {
      background: linear-gradient(135deg, #1a2332 0%, #2d3e50 100%);
      color: white;
      padding: 10px 0;
      box-shadow: 0 4px 12px rgba(0,0,0,0.3);
      position: sticky;
      top: 0;
      z-index: 1000;
      width: 100%;
    }

    .header-content {
      max-width: 1200px;
      margin: 0 auto;
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0 20px;
      flex-wrap: wrap;
    }

    .logo-section {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .logo {
      width: 100px;
      height: 100px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 42px;
    }

    .church-info h1 {
      margin: 0;
      font-size: 22px;
      color: #FFD700;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
    }

    .church-info p {
      margin: 3px 0 0 0;
      font-size: 12px;
      color: #f0f0f0;
    }

    nav {
      position: relative;
    }

    .menu-toggle {
      background: rgba(255, 255, 255, 0.2);
      border: 2px solid #FFD700;
      color: white;
      padding: 12px 25px;
      border-radius: 25px;
      cursor: pointer;
      font-size: 16px;
      font-weight: 600;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .menu-toggle:hover {
      background: #FFD700;
      color: #1a2332;
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(255, 215, 0, 0.4);
    }

    .dropdown-menu {
      display: none;
      position: absolute;
      top: 100%;
      right: 0;
      background: #2d3e50;
      border: 2px solid #FFD700;
      border-radius: 15px;
      margin-top: 10px;
      min-width: 200px;
      box-shadow: 0 8px 24px rgba(0,0,0,0.3);
      z-index: 1000;
    }

    .dropdown-menu.show {
      display: block;
      animation: fadeIn 0.3s ease;
    }

    .dropdown-menu button {
      display: block;
      width: 100%;
      background: transparent;
      border: none;
      color: white;
      padding: 15px 20px;
      text-align: left;
      cursor: pointer;
      font-size: 14px;
      font-weight: 600;
      transition: all 0.3s ease;
      border-bottom: 1px solid rgba(255, 215, 0, 0.2);
    }

    .dropdown-menu button:last-child {
      border-bottom: none;
    }

    .dropdown-menu button:hover, .dropdown-menu button.active {
      background: #FFD700;
      color: #1a2332;
    }

    /* Live Alert Banner */
    .live-alert {
      background: linear-gradient(90deg, #dc2626 0%, #ef4444 100%);
      color: white;
      padding: 15px;
      text-align: center;
      font-weight: bold;
      font-size: 18px;
      animation: pulse 2s infinite;
      display: none;
      width: 100%;
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.8; }
    }

    .live-alert button {
      background: white;
      color: #dc2626;
      border: none;
      padding: 10px 25px;
      border-radius: 25px;
      font-weight: bold;
      cursor: pointer;
      margin-left: 15px;
      transition: transform 0.2s;
    }

    .live-alert button:hover {
      transform: scale(1.05);
    }

    /* Main Content */
    .main-container {
      width: 100%;
      min-height: calc(100% - 200px);
      background: white;
    }

    .content {
      max-width: 1200px;
      margin: 0 auto;
      padding: 40px 20px;
    }

    .page {
      display: none;
    }

    .page.active {
      display: block;
      animation: fadeIn 0.5s ease;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* Home Page */
    .hero {
      text-align: center;
      padding: 60px 20px;
      background: linear-gradient(135deg, #1a2332 0%, #2d3e50 100%);
      color: white;
      border-radius: 15px;
      margin-bottom: 40px;
      box-shadow: 0 8px 24px rgba(0,0,0,0.2);
    }

    .hero h2 {
      font-size: 42px;
      margin: 0 0 15px 0;
      color: #FFD700;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
    }

    .hero p {
      font-size: 20px;
      margin: 10px 0;
      line-height: 1.6;
    }

    .bible-verse {
      font-style: italic;
      font-size: 18px;
      margin-top: 20px;
      padding: 15px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 10px;
      border-left: 4px solid #FFD700;
    }

    .cta-buttons {
      display: flex;
      gap: 20px;
      justify-content: center;
      margin-top: 30px;
      flex-wrap: wrap;
    }

    .cta-btn {
      background: #FFD700;
      color: #1a2332;
      border: none;
      padding: 15px 35px;
      font-size: 18px;
      font-weight: bold;
      border-radius: 30px;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 4px 12px rgba(255, 215, 0, 0.3);
    }

    .cta-btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 6px 20px rgba(255, 215, 0, 0.5);
    }

    .events-section {
      margin-top: 40px;
    }

    .events-section h3 {
      font-size: 32px;
      color: #1e3c72;
      margin-bottom: 25px;
      text-align: center;
    }

    .events-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 25px;
      margin-top: 20px;
    }

    .event-card {
      background: linear-gradient(135deg, #e0f2fe 0%, #bae6fd 100%);
      border: 2px solid #0ea5e9;
      border-radius: 15px;
      padding: 25px;
      box-shadow: 0 4px 12px rgba(14,165,233,0.2);
      transition: transform 0.3s ease;
    }

    .event-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 20px rgba(14,165,233,0.3);
    }

    .event-card h4 {
      color: #0c4a6e;
      font-size: 22px;
      margin: 0 0 10px 0;
    }

    .event-card p {
      color: #0c4a6e;
      margin: 5px 0;
      line-height: 1.6;
    }

    /* Department Cards */
    .department-card {
      background: white;
      border: 2px solid #FFD700;
      border-radius: 15px;
      overflow: hidden;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      transition: transform 0.3s ease;
    }

    .department-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 20px rgba(0,0,0,0.15);
    }

    .department-card img {
      width: 100%;
      height: 200px;
      object-fit: cover;
    }

    .department-info {
      padding: 20px;
    }

    .department-info h4 {
      color: #1e3c72;
      font-size: 22px;
      margin: 0 0 10px 0;
    }

    .department-info p {
      color: #555;
      margin: 5px 0;
      line-height: 1.6;
    }

    .department-actions {
      display: flex;
      gap: 10px;
      margin-top: 15px;
    }

    .department-actions button {
      flex: 1;
      padding: 8px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-weight: bold;
      transition: all 0.2s;
    }

    /* Section Styling */
    .section-title {
      font-size: 36px;
      color: #1a2332;
      margin-bottom: 25px;
      text-align: center;
      position: relative;
      padding-bottom: 15px;
    }

    .section-title::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 80px;
      height: 4px;
      background: #FFD700;
      border-radius: 2px;
    }

    .content-box {
      background: #f9f9f9;
      border-left: 5px solid #FFD700;
      padding: 25px;
      margin: 20px 0;
      border-radius: 10px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }

    .content-box h3 {
      color: #1e3c72;
      margin-top: 0;
    }

    .content-box p {
      line-height: 1.8;
      color: #555;
    }

    /* Services Grid */
    .services-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 25px;
      margin-top: 30px;
    }

    .service-card {
      background: linear-gradient(135deg, #1a2332 0%, #2d3e50 100%);
      color: white;
      padding: 30px;
      border-radius: 15px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
      transition: transform 0.3s ease;
    }

    .service-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 20px rgba(0,0,0,0.3);
    }

    .service-card h4 {
      color: #FFD700;
      font-size: 22px;
      margin: 0 0 15px 0;
    }

    .service-card .time {
      font-size: 18px;
      font-weight: bold;
      color: #FFD700;
      margin: 10px 0;
    }

    /* Giving Page */
    .giving-container {
      max-width: 600px;
      margin: 0 auto;
    }

    .account-details {
      background: #f0f8ff;
      border: 2px solid #1e3c72;
      padding: 30px;
      border-radius: 15px;
      margin: 20px 0;
      text-align: center;
    }

    .account-details h3 {
      color: #1e3c72;
      margin-top: 0;
    }

    .account-info {
      font-size: 18px;
      margin: 15px 0;
      color: #333;
    }

    .account-info strong {
      color: #1e3c72;
      display: block;
      margin-bottom: 5px;
    }

    .give-card-btn {
      background: #FFD700;
      color: #1a2332;
      border: none;
      padding: 18px 40px;
      font-size: 20px;
      font-weight: bold;
      border-radius: 30px;
      cursor: pointer;
      margin: 20px auto;
      display: block;
      transition: all 0.3s ease;
      box-shadow: 0 4px 12px rgba(255, 215, 0, 0.3);
    }

    .give-card-btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 6px 20px rgba(255, 215, 0, 0.5);
    }

    /* Media Page */
    .media-controls {
      background: #f0f8ff;
      padding: 20px;
      border-radius: 10px;
      margin-bottom: 30px;
      display: none;
    }

    .media-controls.show {
      display: block;
    }

    .upload-form {
      display: grid;
      gap: 15px;
      max-width: 600px;
      margin: 0 auto;
    }

    .upload-form input, .upload-form select, .upload-form textarea {
      padding: 12px;
      border: 2px solid #ddd;
      border-radius: 8px;
      font-size: 16px;
    }

    .upload-form button {
      background: #1a2332;
      color: white;
      border: none;
      padding: 15px;
      font-size: 16px;
      font-weight: bold;
      border-radius: 8px;
      cursor: pointer;
      transition: background 0.3s ease;
    }

    .upload-form button:hover {
      background: #2d3e50;
    }

    .media-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 25px;
      margin-top: 30px;
    }

    .media-item {
      background: white;
      border-radius: 15px;
      overflow: hidden;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      transition: transform 0.3s ease;
    }

    .media-item:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 20px rgba(0,0,0,0.15);
    }

    .media-item img, .media-item video {
      width: 100%;
      height: 200px;
      object-fit: cover;
    }

    .media-info {
      padding: 20px;
    }

    .media-info h4 {
      color: #1e3c72;
      margin: 0 0 10px 0;
      font-size: 18px;
    }

    .media-info p {
      color: #666;
      margin: 5px 0;
      font-size: 14px;
    }

    .media-actions {
      display: flex;
      gap: 10px;
      margin-top: 15px;
    }

    .media-actions button {
      flex: 1;
      padding: 8px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-weight: bold;
      transition: all 0.2s;
    }

    .download-btn {
      background: #FFD700;
      color: #1e3c72;
    }

    .download-btn:hover {
      background: #ffc700;
    }

    .delete-btn {
      background: #dc2626;
      color: white;
      display: none;
    }

    .delete-btn.show {
      display: block;
    }

    .delete-btn:hover {
      background: #b91c1c;
    }

    /* Prayer Form */
    .prayer-form {
      max-width: 600px;
      margin: 0 auto;
      background: #f9f9f9;
      padding: 30px;
      border-radius: 15px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }

    .prayer-form input, .prayer-form textarea {
      width: 100%;
      padding: 12px;
      margin: 10px 0;
      border: 2px solid #ddd;
      border-radius: 8px;
      font-size: 16px;
      font-family: inherit;
    }

    .prayer-form textarea {
      min-height: 150px;
      resize: vertical;
    }

    .prayer-form button {
      width: 100%;
      background: #1e3c72;
      color: white;
      border: none;
      padding: 15px;
      font-size: 18px;
      font-weight: bold;
      border-radius: 8px;
      cursor: pointer;
      margin-top: 10px;
      transition: background 0.3s ease;
    }

    .prayer-form button:hover {
      background: #2a5298;
    }

    .contact-info {
      background: #f0f8ff;
      padding: 20px;
      border-radius: 10px;
      margin: 20px 0;
    }

    .contact-info p {
      margin: 10px 0;
      font-size: 16px;
      color: #333;
    }

    .contact-info strong {
      color: #1e3c72;
    }

    /* Partnership Form */
    .partnership-form {
      max-width: 600px;
      margin: 30px auto;
      background: #f9f9f9;
      padding: 30px;
      border-radius: 15px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }

    .partnership-form h3 {
      color: #1e3c72;
      margin-top: 0;
      text-align: center;
    }

    .partnership-form input, .partnership-form select {
      width: 100%;
      padding: 12px;
      margin: 10px 0;
      border: 2px solid #ddd;
      border-radius: 8px;
      font-size: 16px;
    }

    .partnership-form button {
      width: 100%;
      background: #FFD700;
      color: #1e3c72;
      border: none;
      padding: 15px;
      font-size: 18px;
      font-weight: bold;
      border-radius: 8px;
      cursor: pointer;
      margin-top: 10px;
      transition: all 0.3s ease;
    }

    .partnership-form button:hover {
      background: #ffc700;
      transform: translateY(-2px);
    }

    /* Auth Section */
    .auth-section {
      max-width: 400px;
      margin: 40px auto;
      background: white;
      padding: 30px;
      border-radius: 15px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      border: 2px solid #FFD700;
    }

    .auth-section h3 {
      color: #1e3c72;
      text-align: center;
      margin-top: 0;
    }

    .auth-section input {
      width: 100%;
      padding: 12px;
      margin: 10px 0;
      border: 2px solid #ddd;
      border-radius: 8px;
      font-size: 16px;
    }

    .auth-section button {
      width: 100%;
      background: #1e3c72;
      color: white;
      border: none;
      padding: 15px;
      font-size: 16px;
      font-weight: bold;
      border-radius: 8px;
      cursor: pointer;
      margin: 10px 0;
      transition: background 0.3s ease;
    }

    .auth-section button:hover {
      background: #2a5298;
    }

    .auth-toggle {
      text-align: center;
      margin-top: 15px;
      color: #666;
    }

    .auth-toggle a {
      color: #1e3c72;
      cursor: pointer;
      font-weight: bold;
      text-decoration: underline;
    }

    .user-info {
      background: #f0f8ff;
      padding: 15px;
      border-radius: 10px;
      margin: 20px 0;
      text-align: center;
    }

    .user-info p {
      margin: 5px 0;
      color: #333;
    }

    .logout-btn {
      background: #dc2626;
      color: white;
      border: none;
      padding: 10px 25px;
      border-radius: 8px;
      cursor: pointer;
      font-weight: bold;
      margin-top: 10px;
      transition: background 0.3s ease;
    }

    .logout-btn:hover {
      background: #b91c1c;
    }

    /* Admin Settings */
    .admin-settings {
      display: none;
      background: #fff3cd;
      padding: 25px;
      border-radius: 10px;
      margin: 20px 0;
      border: 2px solid #FFD700;
    }

    .admin-settings.show {
      display: block;
    }

    .admin-settings h3 {
      color: #1e3c72;
      margin-top: 0;
    }

    .admin-settings h4 {
      color: #1e3c72;
      margin: 20px 0 10px 0;
    }

    .live-controls {
      display: flex;
      gap: 15px;
      margin: 20px 0;
      flex-wrap: wrap;
      align-items: center;
    }

    .live-controls button {
      padding: 12px 25px;
      border: none;
      border-radius: 8px;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .go-live-btn {
      background: #dc2626;
      color: white;
    }

    .go-live-btn:hover {
      background: #b91c1c;
    }

    .end-live-btn {
      background: #6b7280;
      color: white;
    }

    .end-live-btn:hover {
      background: #4b5563;
    }

    .stream-url-inputs {
      margin-top: 20px;
    }

    .stream-url-inputs label {
      display: block;
      color: #1e3c72;
      font-weight: bold;
      margin: 15px 0 5px 0;
    }

    .stream-url-inputs input, .stream-url-inputs textarea {
      width: 100%;
      padding: 10px;
      border: 2px solid #ddd;
      border-radius: 8px;
      font-size: 14px;
    }

    /* Social Links */
    .social-links {
      display: flex;
      gap: 15px;
      justify-content: center;
      margin: 30px 0;
      flex-wrap: wrap;
    }

    .social-btn {
      width: 50px;
      height: 50px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
      cursor: pointer;
      transition: transform 0.3s ease;
      text-decoration: none;
      color: white;
      box-shadow: 0 2px 8px rgba(0,0,0,0.2);
    }

    .social-btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 4px 12px rgba(0,0,0,0.3);
    }

    .facebook { background: #1877f2; }
    .youtube { background: #ff0000; }
    .tiktok { background: #000000; }
    .twitch { background: #9146ff; }
    .whatsapp { background: #25d366; }

    /* Footer */
    footer {
      background: #1a2332;
      color: white;
      text-align: center;
      padding: 40px 20px;
      margin-top: 60px;
      width: 100%;
    }

    footer p {
      margin: 12px 0;
      font-size: 18px;
    }

    /* Countdown Timer */
    .countdown-container {
      background: linear-gradient(135deg, #dc2626 0%, #ef4444 100%);
      color: white;
      padding: 30px;
      border-radius: 15px;
      margin: 30px 0;
      text-align: center;
      box-shadow: 0 8px 24px rgba(220, 38, 38, 0.3);
    }

    .countdown-container h3 {
      margin: 0 0 20px 0;
      font-size: 28px;
      color: white;
    }

    .countdown-timer {
      display: flex;
      gap: 20px;
      justify-content: center;
      flex-wrap: wrap;
    }

    .countdown-item {
      background: rgba(255, 255, 255, 0.2);
      padding: 15px 25px;
      border-radius: 10px;
      min-width: 80px;
    }

    .countdown-value {
      font-size: 36px;
      font-weight: bold;
      display: block;
    }

    .countdown-label {
      font-size: 14px;
      text-transform: uppercase;
      opacity: 0.9;
    }

    /* Toast Notifications */
    .toast {
      position: fixed;
      bottom: 30px;
      right: 30px;
      background: #1a2332;
      color: white;
      padding: 15px 25px;
      border-radius: 10px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.3);
      z-index: 10000;
      animation: slideIn 0.3s ease;
      max-width: 300px;
    }

    .toast.success {
      background: #10b981;
    }

    .toast.error {
      background: #dc2626;
    }

    @keyframes slideIn {
      from {
        transform: translateX(400px);
        opacity: 0;
      }
      to {
        transform: translateX(0);
        opacity: 1;
      }
    }

    /* Responsive */
    @media (max-width: 768px) {
      .header-content {
        flex-direction: column;
        gap: 15px;
      }

      nav {
        justify-content: center;
      }

      .hero h2 {
        font-size: 28px;
      }

      .hero p {
        font-size: 16px;
      }

      .cta-buttons {
        flex-direction: column;
      }

      .section-title {
        font-size: 28px;
      }

      .events-grid, .services-grid, .media-grid {
        grid-template-columns: 1fr;
      }
    }

    /* Loading Spinner */
    .loading-spinner {
      border: 4px solid #f3f3f3;
      border-top: 4px solid #1e3c72;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      animation: spin 1s linear infinite;
      margin: 20px auto;
      display: none;
    }

    .loading-spinner.show {
      display: block;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    /* Upload Progress */
    .upload-progress {
      width: 100%;
      height: 8px;
      background: #e0e0e0;
      border-radius: 4px;
      overflow: hidden;
      margin: 10px 0;
      display: none;
    }

    .upload-progress.show {
      display: block;
    }

    .upload-progress-bar {
      height: 100%;
      background: #1e3c72;
      transition: width 0.3s ease;
    }

    .upload-status {
      text-align: center;
      margin: 10px 0;
      color: #1e3c72;
      font-weight: bold;
      display: none;
    }

    .upload-status.show {
      display: block;
    }
  </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="https://cdn.tailwindcss.com" type="text/javascript"></script>
 </head>
 <body><!-- Live Alert Banner -->
  <div class="live-alert" id="homeLiveAlert">
   üî¥ WE ARE LIVE NOW! <button onclick="navigateTo('media')">WATCH NOW</button>
  </div><!-- Header -->
  <header>
   <div class="header-content">
    <div class="logo-section">
     <div class="logo" style="overflow: hidden;"><img src="https://lh3.googleusercontent.com/d/1vV6tbXgw-7RB60wnzL-nGUQLz3xXO8S3" alt="VIM Logo" style="width: 100%; height: 100%; object-fit: contain;" onerror="this.parentElement.innerHTML='üî•'; this.parentElement.style.fontSize='32px'; this.parentElement.style.display='flex'; this.parentElement.style.alignItems='center'; this.parentElement.style.justifyContent='center';">
     </div>
     <div class="church-info">
      <h1 id="headerChurchName">Vibrant Impact Ministries</h1>
      <p id="headerSlogan">Raising Vibrant Believers for Kingdom Impact</p>
     </div>
    </div>
    <nav><button class="menu-toggle" onclick="toggleMenu()"> ‚ò∞ Menu </button>
     <div class="dropdown-menu" id="dropdownMenu"><button class="active" onclick="navigateTo('home')">Home</button> <button onclick="navigateTo('about')">About</button> <button onclick="navigateTo('departments')">Departments</button> <button onclick="navigateTo('services')">Services</button> <button onclick="navigateTo('giving')">Giving</button> <button onclick="navigateTo('media')">Media</button> <button onclick="navigateTo('prayer')">Prayer</button> <button onclick="navigateTo('contact')">Contact</button> <button id="authNavBtn" onclick="navigateTo('auth')">Login</button> <button id="accountNavBtn" onclick="navigateTo('account')" style="display: none;">üë§ My Account</button> <button id="adminSettingsNavBtn" onclick="navigateTo('auth')" style="display: none;">‚öôÔ∏è Admin Settings</button>
     </div>
    </nav>
   </div>
  </header>
  <div class="main-container">
   <div class="content"><!-- HOME PAGE -->
    <div id="home" class="page active">
     <div class="hero" id="heroSection" style="position: relative; transition: background-image 1s ease-in-out;">
      <div style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(30, 60, 114, 0.85); border-radius: 15px;"></div>
      <div style="position: relative; z-index: 1;">
       <h2 id="welcomeTitle">Welcome to Vibrant Impact Ministries</h2>
       <p id="churchSloganDisplay">Raising Vibrant Believers for Kingdom Impact</p>
       <div class="bible-verse">
        "Not by might, nor by power, but by my Spirit, says the LORD of hosts." - Zechariah 4:6
       </div>
       <div class="cta-buttons"><button class="cta-btn" onclick="navigateTo('services')">üìÖ Service Days</button> <button class="cta-btn" onclick="navigateTo('giving')">üíù Give Online</button> <button class="cta-btn" onclick="navigateTo('media')">üì∫ Watch Live</button>
       </div>
      </div>
     </div>
     <div class="countdown-container" id="fireNightCountdown">
      <h3>üî• Next Fire Night Countdown</h3>
      <div class="countdown-timer">
       <div class="countdown-item"><span class="countdown-value" id="days">00</span> <span class="countdown-label">Days</span>
       </div>
       <div class="countdown-item"><span class="countdown-value" id="hours">00</span> <span class="countdown-label">Hours</span>
       </div>
       <div class="countdown-item"><span class="countdown-value" id="minutes">00</span> <span class="countdown-label">Minutes</span>
       </div>
       <div class="countdown-item"><span class="countdown-value" id="seconds">00</span> <span class="countdown-label">Seconds</span>
       </div>
      </div>
     </div>
     <div id="gloryServiceVideoSection" class="events-section" style="display: none;">
      <h3>üåü Sunday Glory Service</h3>
      <div style="max-width: 800px; margin: 0 auto; border-radius: 15px; overflow: hidden; box-shadow: 0 8px 24px rgba(0,0,0,0.2);">
       <iframe id="gloryServiceVideoFrame" src="" style="width: 100%; aspect-ratio: 16/9; border: none;" allowfullscreen></iframe>
      </div>
     </div>
     <div id="tuesdayCounsellingVideoSection" class="events-section" style="display: none;">
      <h3>üôè Tuesday Counselling Service</h3>
      <div style="max-width: 800px; margin: 0 auto; border-radius: 15px; overflow: hidden; box-shadow: 0 8px 24px rgba(0,0,0,0.2);">
       <iframe id="tuesdayCounsellingVideoFrame" src="" style="width: 100%; aspect-ratio: 16/9; border: none;" allowfullscreen></iframe>
      </div>
     </div>
     <div class="events-section">
      <h3>Upcoming Services &amp; Events</h3>
      <div class="events-grid" id="upcomingEventsGrid">
       <p style="text-align: center; color: #666; padding: 40px;">Loading upcoming services...</p>
      </div>
     </div>
     <div class="social-links"><a href="https://facebook.com/VibrantImpactMinistries" target="_blank" rel="noopener noreferrer" class="social-btn facebook" title="Facebook">
       <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" fill="white">
        <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z" />
       </svg></a> <a href="https://youtube.com/@ProphetValentineIfedayoChannel" target="_blank" rel="noopener noreferrer" class="social-btn youtube" title="YouTube">
       <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" fill="white">
        <path d="M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z" />
       </svg></a> <a href="https://tiktok.com/@prophet_valentineifedayo" target="_blank" rel="noopener noreferrer" class="social-btn tiktok" title="TikTok">
       <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" fill="white">
        <path d="M19.59 6.69a4.83 4.83 0 0 1-3.77-4.25V2h-3.45v13.67a2.89 2.89 0 0 1-5.2 1.74 2.89 2.89 0 0 1 2.31-4.64 2.93 2.93 0 0 1 .88.13V9.4a6.84 6.84 0 0 0-1-.05A6.33 6.33 0 0 0 5 20.1a6.34 6.34 0 0 0 10.86-4.43v-7a8.16 8.16 0 0 0 4.77 1.52v-3.4a4.85 4.85 0 0 1-1-.1z" />
       </svg></a> <a href="https://twitch.tv/vibrantimpactministries" target="_blank" rel="noopener noreferrer" class="social-btn twitch" title="Twitch">
       <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" fill="white">
        <path d="M11.571 4.714h1.715v5.143H11.57zm4.715 0H18v5.143h-1.714zM6 0L1.714 4.286v15.428h5.143V24l4.286-4.286h3.428L22.286 12V0zm14.571 11.143l-3.428 3.428h-3.429l-3 3v-3H6.857V1.714h13.714Z" />
       </svg></a> <a href="https://chat.whatsapp.com/your-group-link" target="_blank" rel="noopener noreferrer" class="social-btn whatsapp" title="WhatsApp Group">
       <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" fill="white">
        <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.890-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z" />
       </svg></a>
     </div>
    </div><!-- ABOUT PAGE -->
    <div id="about" class="page">
     <h2 class="section-title">About Us</h2>
     <div class="content-box">
      <h3>Our History</h3>
      <p id="aboutHistoryText">Vibrant Impact Ministries (VIM) was established in 2020 with a divine mandate to raise vibrant believers who would make lasting kingdom impact. Located in the heart of Akure, Ondo State, Nigeria, we are a prophetic and teaching church committed to equipping believers for effective kingdom service.</p>
     </div>
     <div class="content-box">
      <h3>Our Departments</h3>
      <p>God has blessed us with dedicated departments serving in various capacities to build His kingdom:</p>
      <div id="departmentsList" style="margin-top: 20px;">
       <div class="loading-spinner"></div>
      </div>
     </div>
     <div class="content-box">
      <h3>Our Vision</h3>
      <p id="aboutVisionText">To raise a generation of vibrant believers who are spiritually alive, prophetically empowered, and making tangible kingdom impact in their communities and beyond.</p>
     </div>
     <div class="content-box">
      <h3>Our Mission</h3>
      <div id="aboutMissionContent">
       <p>We are committed to:</p>
       <ul>
        <li>Teaching the uncompromised Word of God</li>
        <li>Activating believers in the prophetic</li>
        <li>Providing deliverance and counseling ministry</li>
        <li>Equipping the saints for kingdom service</li>
        <li>Raising prayer warriors and intercessors</li>
       </ul>
      </div>
     </div>
     <div class="content-box">
      <h3>Our Beliefs</h3>
      <p id="aboutBeliefsText">We believe in the infallibility of Scripture, the deity of Jesus Christ, salvation through faith in Christ alone, the baptism of the Holy Spirit, divine healing, and the imminent return of our Lord Jesus Christ.</p>
     </div>
     <div class="content-box">
      <h3 id="pastorNameDisplay">Prophet Valentine Ifedayo</h3>
      <div style="display: flex; justify-content: center; margin: 20px 0;"><img id="pastorPhoto" src="https://lh3.googleusercontent.com/d/19iPQ2uK4vDTMBCeXxDt03GvMnn2h-C_a" alt="Prophet Valentine Ifedayo" style="width: 180px; height: 180px; object-fit: cover; border-radius: 50%; box-shadow: 0 4px 12px rgba(0,0,0,0.2); border: 4px solid #FFD700;" onerror="this.style.display='none';">
      </div>
      <p id="pastorBioText">Prophet Valentine Ifedayo is the Lead Pastor and Founder of Vibrant Impact Ministries. Called by God as a prophet and teacher, he carries a burden for raising believers who are spiritually alive and impactful. His teaching ministry emphasizes practical kingdom living, prophetic activation, and spiritual warfare.</p>
      <p id="pastorBioText2">Prophet Valentine is passionate about seeing believers walk in their God-given purpose and destiny. His ministry is characterized by the demonstration of the Spirit's power, accurate prophetic ministry, and life-transforming teaching of God's Word.</p>
     </div>
     <div class="content-box" id="pastorWifeSection" style="display: none;">
      <h3 id="pastorWifeNameDisplay">Pastor's Wife</h3>
      <div style="display: flex; justify-content: center; margin: 20px 0;"><img id="pastorWifeImage" src="" alt="Pastor's Wife" style="width: 180px; height: 180px; object-fit: cover; border-radius: 50%; box-shadow: 0 4px 12px rgba(0,0,0,0.2); border: 4px solid #FFD700; display: none;" onerror="this.style.display='none';">
      </div>
      <p id="pastorWifeBioText"></p>
     </div>
    </div><!-- DEPARTMENTS PAGE -->
    <div id="departments" class="page">
     <h2 class="section-title">Our Departments</h2><!-- User Info & Admin Controls -->
     <div id="departmentsUserSection"></div><!-- Admin Upload Controls -->
     <div class="media-controls" id="adminDepartmentSection">
      <h3 id="deptFormTitle">Add Department (Admin Only)</h3>
      <form class="upload-form" id="departmentForm" onsubmit="saveDepartment(event)"><input type="hidden" id="deptId" value=""> <input type="text" id="deptName" placeholder="Department Name *" required> <textarea id="deptDescription" placeholder="Department Description *" rows="4" required></textarea> <input type="url" id="deptImageUrl" placeholder="Department Image URL *" required> <button type="submit" id="deptSubmitBtn">Add Department</button> <button type="button" id="deptCancelBtn" onclick="cancelEditDepartment()" style="display: none; background: #6b7280; color: white; margin-top: 10px;">Cancel Edit</button>
      </form>
     </div>
     <div class="loading-spinner" id="departmentsLoading"></div><!-- Departments Grid -->
     <div class="events-grid" id="departmentsGrid"></div>
    </div><!-- SERVICES PAGE -->
    <div id="services" class="page">
     <h2 class="section-title">Our Services &amp; Programs</h2>
     <div class="services-grid">
      <div class="service-card">
       <h4>üåü Sunday Glory Service</h4>
       <p class="time">9:00 AM</p>
       <p>Our main worship service featuring powerful praise and worship, life-transforming messages, and prophetic ministry. Come experience the glory of God!</p>
      </div>
      <div class="service-card">
       <h4>üôè Tuesday Deliverance &amp; Counselling</h4>
       <p class="time">9:00 AM</p>
       <p>A special service dedicated to deliverance ministry and pastoral counseling. Bring your burdens and receive freedom and guidance.</p>
      </div>
      <div class="service-card">
       <h4>üíª Tuesday Online Prayer</h4>
       <p class="time">6:00 PM</p>
       <p>Join us online for focused prayer and intercession. Connect from anywhere as we pray together for breakthroughs and miracles.</p>
      </div>
      <div class="service-card">
       <h4>üéØ Friday Youth Fellowship</h4>
       <p class="time">4:00 PM</p>
       <p>A vibrant gathering for young people to fellowship, learn, and grow in their faith. Dynamic worship and relevant teaching for today's youth.</p>
      </div>
      <div class="service-card">
       <h4>üìñ Friday Bible Study</h4>
       <p class="time">6:00 PM</p>
       <p>Deep dive into the Word of God. Expository teaching that builds your faith and understanding of Scripture.</p>
      </div>
      <div class="service-card">
       <h4>üî• Last Friday Fire Night</h4>
       <p class="time">10:00 PM</p>
       <p>An atmosphere of intense prayer, worship, and prophetic ministry. Experience supernatural breakthroughs and encounters with God.</p>
      </div>
      <div class="service-card">
       <h4>ü§ù Saturday Partners Prayer &amp; Fasting</h4>
       <p class="time">6:00 PM</p>
       <p>Join our ministry partners for corporate prayer and fasting. Seeking God's face together for revival and kingdom advancement.</p>
      </div>
     </div>
    </div><!-- GIVING PAGE -->
     <div id="giving" class="page">
     <h2 class="section-title">Give &amp; Partner With Us</h2>
     <div class="giving-container">
      <div class="content-box">
       <p style="text-align: center; font-size: 18px; line-height: 1.8;">Your giving helps us spread the Gospel, impact lives, and advance the Kingdom of God. Thank you for your partnership in ministry!</p>
      </div><button class="give-card-btn" id="paystackBtn" onclick="openGiveLink('paystack')"> üí≥ Give with Card (Paystack) </button> <button class="give-card-btn" id="paypalBtn" onclick="openGiveLink('paypal')" style="margin-top: 10px;"> üí∞ Give with PayPal </button>
      <div class="account-details">
       <h3>Bank Transfer Details</h3>
       <div class="account-info"><strong>Bank:</strong> <span id="bankNameDisplay">UBA (United Bank for Africa)</span>
       </div>
       <div class="account-info"><strong>Account Number:</strong> <span id="accountNumberDisplay">1025522432</span>
       </div>
       <div class="account-info"><strong>Account Name:</strong> <span id="accountNameDisplay">Valentine Ifedayo Ministries</span>
       </div>
      </div>
      <div class="partnership-form">
       <h3>Become a Ministry Partner</h3>
       <form id="partnershipForm" onsubmit="submitPartnership(event)"><input type="text" id="partnerName" placeholder="Full Name *" required> <input type="email" id="partnerEmail" placeholder="Email Address *" required> <input type="tel" id="partnerPhone" placeholder="Phone Number *" required> <select id="partnershipType" required> <option value="">Select Partnership Level *</option> <option value="VIM Partners">VIM Partners</option> <option value="Widows Care Partners">Widows Care Partners</option> </select> <button type="submit">Register as Partner</button>
       </form>
      </div>
     </div>
    </div><!-- MEDIA PAGE -->
    <div id="media" class="page"><!-- Live Alert Banner -->
     <div class="live-alert" id="mediaLiveAlert">
      üî¥ WE ARE LIVE NOW! <button onclick="openLiveStream()">WATCH NOW</button>
     </div>
     <h2 class="section-title">Media Gallery</h2><!-- User Info & Admin Controls -->
     <div id="mediaUserSection"></div><!-- Admin Upload Controls -->
     <div class="media-controls" id="adminUploadSection">
      <h3>Upload Media (Admin Only)</h3>
      <form class="upload-form" id="uploadForm" onsubmit="uploadMedia(event)"><select id="mediaType" required> <option value="">Select Type *</option> <option value="image">Image</option> <option value="video">Video</option> </select> <input type="text" id="mediaTitle" placeholder="Title *" required> <textarea id="mediaDescription" placeholder="Description" rows="3"></textarea> <select id="mediaCategory" required> <option value="">Select Category *</option> <option value="sermon">Recent Sermons</option> <option value="firenight">Fire Night Highlights</option> <option value="youth">Youth Fellowship</option> <option value="events">Special Events</option> <option value="worship">Worship Moments</option> </select> <select id="mediaLanguage" required> <option value="">Select Language *</option> <option value="English">English</option> <option value="Mandola">Mandola Dialect</option> <option value="Yoruba">Yoruba</option> <option value="Pidgin">Nigerian Pidgin</option> <option value="Other">Other</option> </select>
       <div style="margin: 15px 0;"><label style="display: block; margin-bottom: 5px; font-weight: bold;">Upload from Computer (Multiple files supported):</label> <input type="file" id="mediaFiles" accept="image/*,video/*" multiple style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 8px;">
        <p style="font-size: 12px; color: #666; margin: 5px 0;">Or enter URL below:</p>
       </div><input type="url" id="mediaUrl" placeholder="Image/Video URL (optional if uploading files)">
       <div class="upload-progress" id="uploadProgress">
        <div class="upload-progress-bar" id="uploadProgressBar"></div>
       </div>
       <div class="upload-status" id="uploadStatus"></div><button type="submit">Upload Media</button>
      </form>
     </div>
     <div class="loading-spinner" id="mediaLoading"></div><!-- Media Grid -->
     <div class="media-grid" id="mediaGallery"></div>
    </div><!-- PRAYER & COUNSELLING PAGE -->
    <div id="prayer" class="page">
     <h2 class="section-title">Prayer &amp; Counselling</h2>
     <div class="content-box">
      <h3>Submit Your Prayer Request</h3>
      <p>We believe in the power of prayer! Share your prayer needs with us, and our prayer team will stand with you in faith.</p>
     </div>
     <form class="prayer-form" id="prayerForm" onsubmit="submitPrayerRequest(event)"><input type="text" id="prayerName" placeholder="Your Name *" required> <input type="email" id="prayerEmail" placeholder="Email Address *" required> <input type="tel" id="prayerPhone" placeholder="Phone Number *" required> <textarea id="prayerRequest" placeholder="Your Prayer Request *" required></textarea> <button type="submit">Submit Prayer Request</button>
     </form>
     <div class="contact-info">
      <h3>Counselling &amp; Deliverance Ministry</h3>
      <p><strong>Schedule:</strong> Every Tuesday at 9:00 AM</p>
      <p><strong>Online Prayer:</strong> Every Tuesday at 6:00 PM</p>
      <p><strong>Email:</strong> <span id="prayerEmailDisplay">pastorvalentineifedayo@gmail.com</span></p>
      <p><strong>Phone:</strong> <span id="prayerPhoneDisplay">+234 (Contact for appointment)</span></p>
      <p>For counselling appointments and deliverance ministry, please contact us via email or phone to schedule a session.</p>
     </div>
    </div><!-- CONTACT PAGE -->
    <div id="contact" class="page">
     <h2 class="section-title">Contact Us</h2>
     <div class="content-box">
      <h3>üìç Church Address</h3>
      <p id="contactAddressDisplay">Ughele Junction, along Ado Road<br>
        Akure, Ondo State<br>
        Nigeria</p>
     </div>
     <div class="content-box">
      <h3>üìû Contact Information</h3>
      <p><strong>Email:</strong> <span id="contactEmailDisplay">pastorvalentineifedayo@gmail.com</span></p>
      <p><strong>Phone:</strong> <span id="contactPhoneDisplay">+234 (Contact for appointment)</span></p>
     </div>
     <div class="content-box">
      <h3>üïê Service Times</h3>
      <p><strong>Sunday:</strong> 9:00 AM - Glory Service</p>
      <p><strong>Tuesday:</strong> 9:00 AM - Deliverance &amp; Counselling</p>
      <p><strong>Tuesday:</strong> 6:00 PM - Online Prayer</p>
      <p><strong>Friday:</strong> 4:00 PM - Youth Fellowship</p>
      <p><strong>Friday:</strong> 6:00 PM - Bible Study</p>
      <p><strong>Last Friday:</strong> 10:00 PM - Fire Night</p>
      <p><strong>Saturday:</strong> 6:00 PM - Partners Prayer &amp; Fasting</p>
     </div>
     <div class="social-links"><a href="https://facebook.com/VibrantImpactMinistries" target="_blank" rel="noopener noreferrer" class="social-btn facebook" title="Facebook">
       <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" fill="white">
        <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z" />
       </svg></a> <a href="https://youtube.com/@ProphetValentineIfedayoChannel" target="_blank" rel="noopener noreferrer" class="social-btn youtube" title="YouTube">
       <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" fill="white">
        <path d="M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z" />
       </svg></a> <a href="https://tiktok.com/@prophet_valentineifedayo" target="_blank" rel="noopener noreferrer" class="social-btn tiktok" title="TikTok">
       <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" fill="white">
        <path d="M19.59 6.69a4.83 4.83 0 0 1-3.77-4.25V2h-3.45v13.67a2.89 2.89 0 0 1-5.2 1.74 2.89 2.89 0 0 1 2.31-4.64 2.93 2.93 0 0 1 .88.13V9.4a6.84 6.84 0 0 0-1-.05A6.33 6.33 0 0 0 5 20.1a6.34 6.34 0 0 0 10.86-4.43v-7a8.16 8.16 0 0 0 4.77 1.52v-3.4a4.85 4.85 0 0 1-1-.1z" />
       </svg></a> <a href="https://twitch.tv/vibrantimpactministries" target="_blank" rel="noopener noreferrer" class="social-btn twitch" title="Twitch">
       <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" fill="white">
        <path d="M11.571 4.714h1.715v5.143H11.57zm4.715 0H18v5.143h-1.714zM6 0L1.714 4.286v15.428h5.143V24l4.286-4.286h3.428L22.286 12V0zm14.571 11.143l-3.428 3.428h-3.429l-3 3v-3H6.857V1.714h13.714Z" />
       </svg></a> <a href="https://chat.whatsapp.com/your-group-link" target="_blank" rel="noopener noreferrer" class="social-btn whatsapp" title="WhatsApp Group">
       <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" fill="white">
        <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.890-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z" />
       </svg></a>
     </div>
     <div class="content-box">
      <h3>üó∫Ô∏è Find Us</h3>
      <p>We're located at Ughele Junction along Ado Road in Akure. Look out for our church building with the VIM logo!</p>
      <p style="margin-top: 15px;"><em>Map integration coming soon...</em></p>
     </div>
    </div><!-- ACCOUNT PAGE (Member/Admin Account Details) -->
    <div id="account" class="page">
     <h2 class="section-title">My Account</h2>
     <div class="user-info" id="accountUserInfo" style="max-width: 600px; margin: 0 auto;">
      <p style="text-align: center; color: #666;">Loading account information...</p>
     </div>
     <div style="max-width: 600px; margin: 30px auto;">
      <div class="content-box">
       <h3>Edit Account Details</h3>
       <form id="editAccountForm" onsubmit="updateAccountDetails(event)" style="display: grid; gap: 15px;"><input type="text" id="editName" placeholder="Full Name *" required style="padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 16px;"> <input type="tel" id="editPhone" placeholder="Phone Number *" required style="padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 16px;"> <input type="email" id="editEmail" placeholder="Email Address" disabled style="padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 16px; background: #f5f5f5;"> <button type="submit" style="background: #FFD700; color: #1e3c72; border: none; padding: 15px; font-size: 16px; font-weight: bold; border-radius: 8px; cursor: pointer;">üíæ Save Changes</button>
       </form>
      </div>
      <div class="content-box" style="margin-top: 20px;">
       <h3>Change Password</h3>
       <form id="changePasswordForm" onsubmit="changePassword(event)" style="display: grid; gap: 15px;"><input type="password" id="currentPassword" placeholder="Current Password *" required style="padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 16px;"> <input type="password" id="newPassword" placeholder="New Password (min 6 characters) *" required minlength="6" style="padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 16px;"> <input type="password" id="confirmNewPassword" placeholder="Confirm New Password *" required minlength="6" style="padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 16px;"> <button type="submit" style="background: #1e3c72; color: white; border: none; padding: 15px; font-size: 16px; font-weight: bold; border-radius: 8px; cursor: pointer;">üîí Change Password</button>
       </form>
      </div>
      <div style="text-align: center; margin-top: 30px;"><button class="logout-btn" onclick="logoutUser()">Logout</button>
      </div>
     </div>
    </div><!-- AUTH PAGE (Login/Signup) -->
    <div id="auth" class="page">
     <h2 class="section-title">Member Login &amp; Registration</h2>
     <div id="authForms"><!-- Login Form -->
      <div class="auth-section" id="loginSection">
       <h3>Login</h3>
       <form id="loginForm" onsubmit="loginUser(event)"><input type="email" id="loginEmail" placeholder="Email Address *" required> <input type="password" id="loginPassword" placeholder="Password *" required> <button type="submit">Login</button>
       </form>
       <div class="auth-toggle">
        Don't have an account? <a onclick="toggleAuthForm('signup')">Sign Up</a>
       </div>
      </div><!-- Signup Form -->
      <div class="auth-section" id="signupSection" style="display: none;">
       <h3>Create Account</h3>
       <form id="signupForm" onsubmit="signupUser(event)"><input type="text" id="signupName" placeholder="Full Name *" required> <input type="email" id="signupEmail" placeholder="Email Address *" required> <input type="password" id="signupPassword" placeholder="Password (min 6 characters) *" required minlength="6"> <input type="tel" id="signupPhone" placeholder="Phone Number *" required> <button type="submit">Sign Up</button>
       </form>
       <div class="auth-toggle">
        Already have an account? <a onclick="toggleAuthForm('login')">Login</a>
       </div>
      </div>
     </div><!-- Logged In User Info -->
     <div class="user-info" id="userInfoSection" style="display: none;">
      <p><strong>Logged in as:</strong> <span id="userEmail"></span></p>
      <p id="adminBadge" style="display: none; color: #FFD700; font-weight: bold;">‚≠ê ADMIN ACCESS</p><button class="logout-btn" onclick="logoutUser()">Logout</button>
     </div><!-- Admin Settings -->
     <div class="admin-settings" id="adminSettings">
      <h3>üîß Admin Controls</h3>
      <div>
       <h4>Live Streaming Status</h4>
       <p>Current Status: <span id="liveStatusText">‚ö´ OFFLINE</span></p>
       <div class="live-controls"><button class="go-live-btn" onclick="setLiveStatus(true)">üî¥ GO LIVE</button> <button class="end-live-btn" onclick="setLiveStatus(false)">‚ö´ END STREAM</button>
       </div>
      </div>
      <div class="stream-url-inputs"><label>YouTube Live Stream URL:</label> <input type="url" id="youtubeLiveUrl" placeholder="https://youtube.com/live/..." onchange="saveLiveStreamUrl('youtube', this.value)"> <label>Facebook Live Stream URL:</label> <input type="url" id="facebookLiveUrl" placeholder="https://facebook.com/..." onchange="saveLiveStreamUrl('facebook', this.value)"> <label>TikTok Live Stream URL:</label> <input type="url" id="tiktokLiveUrl" placeholder="https://tiktok.com/..." onchange="saveLiveStreamUrl('tiktok', this.value)">
      </div>
      <hr style="margin: 30px 0; border: none; border-top: 2px solid #FFD700;">
      <div>
       <h4>üñºÔ∏è Church Logo</h4>
       <div style="display: flex; align-items: center; gap: 15px; margin: 15px 0; flex-wrap: wrap;">
        <div class="logo" style="overflow: hidden;" id="adminLogoPreview"><img src="https://lh3.googleusercontent.com/d/1vV6tbXgw-7RB60wnzL-nGUQLz3xXO8S3" alt="VIM Logo" style="width: 100%; height: 100%; object-fit: contain;" onerror="this.parentElement.innerHTML='üî•'; this.parentElement.style.fontSize='32px';">
        </div>
        <div style="flex: 1; min-width: 250px;"><input type="url" id="logoUrl" placeholder="Enter logo image URL" style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 8px; margin-bottom: 10px;"> <button onclick="updateLogo()" style="background: #1e3c72; color: white; border: none; padding: 10px 20px; border-radius: 8px; cursor: pointer; font-weight: bold; width: 100%;">Update Logo</button>
        </div>
       </div>
      </div>
      <hr style="margin: 30px 0; border: none; border-top: 2px solid #FFD700;">
      <div>
       <h4>üîó Social Media Links</h4>
       <div class="stream-url-inputs"><label>Facebook Page URL:</label> <input type="url" id="facebookPageUrl" placeholder="https://facebook.com/vibrantimpactministries" onchange="saveSocialLink('facebook', this.value)"> <label>YouTube Channel URL:</label> <input type="url" id="youtubeChannelUrl" placeholder="https://youtube.com/@vibrantimpactministries" onchange="saveSocialLink('youtube', this.value)"> <label>TikTok Profile URL:</label> <input type="url" id="tiktokProfileUrl" placeholder="https://tiktok.com/@vibrantimpactministries" onchange="saveSocialLink('tiktok', this.value)"> <label>Twitch Channel URL:</label> <input type="url" id="twitchChannelUrl" placeholder="https://twitch.tv/vibrantimpactministries" onchange="saveSocialLink('twitch', this.value)"> <label>WhatsApp Group Link:</label> <input type="url" id="whatsappGroupUrl" placeholder="https://chat.whatsapp.com/your-group-link" onchange="saveSocialLink('whatsapp', this.value)">
       </div>
      </div>
     <hr style="margin: 30px 0; border: none; border-top: 2px solid #FFD700;">
     <div>
      <h4>üôè Prayer Requests (Admin Only)</h4>
      <p style="color: #666; font-size: 14px;">View and manage submitted prayer requests.</p>
      <div style="display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 10px;">
       <button onclick="loadPrayerRequests()" style="background: #1e3c72; color: white; border: none; padding: 10px 16px; border-radius: 6px; cursor: pointer; font-weight: bold;">üîÑ Refresh</button>
      </div>
      <div id="prayerRequestsList" style="display: grid; gap: 10px;"></div>
     </div>
     <hr style="margin: 30px 0; border: none; border-top: 2px solid #FFD700;">
     <div>
      <h4>ü§ù Partnership Registrations (Admin Only)</h4>
      <p style="color: #666; font-size: 14px;">View registered partners and send them the WhatsApp group link.</p>
      <div style="display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 10px;">
       <button onclick="loadPartnershipRegistrations()" style="background: #1e3c72; color: white; border: none; padding: 10px 16px; border-radius: 6px; cursor: pointer; font-weight: bold;">üîÑ Refresh</button>
       <button onclick="copyAllEmails()" style="background: #25D366; color: white; border: none; padding: 10px 16px; border-radius: 6px; cursor: pointer; font-weight: bold;">üìã Copy All Emails</button>
       <button onclick="openEmailClient()" style="background: #FFD700; color: #1e3c72; border: none; padding: 10px 16px; border-radius: 6px; cursor: pointer; font-weight: bold;">üìß Email All Partners</button>
      </div>
      <div style="background: #f9f9f9; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
       <label style="display: block; margin-bottom: 5px; font-weight: bold;">WhatsApp Group Link (for emailing):</label>
       <input type="url" id="whatsappLinkForEmail" placeholder="https://chat.whatsapp.com/your-group-link" style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 8px;" onchange="saveWhatsAppLinkForEmail(this.value)">
       <p style="color: #888; font-size: 12px; margin-top: 5px;">This link will be included when emailing partners.</p>
      </div>
      <div id="partnershipRegistrationsList" style="display: grid; gap: 10px;"></div>
     </div>
     <hr style="margin: 30px 0; border: none; border-top: 2px solid #FFD700;">
     <div>
      <h4>üí≥ Giving &amp; Payment Details</h4>
      <div class="stream-url-inputs">
       <label>Paystack Link:</label>
       <input type="url" id="adminPaystackUrl" placeholder="https://paystack.com/pay/..." style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 8px;">
       <label>PayPal Link:</label>
       <input type="url" id="adminPaypalUrl" placeholder="https://paypal.me/..." style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 8px;">
       <label>Bank Name:</label>
       <input type="text" id="adminBankName" placeholder="UBA (United Bank for Africa)" style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 8px;">
       <label>Account Number:</label>
       <input type="text" id="adminAccountNumber" placeholder="1025522432" style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 8px;">
       <label>Account Name:</label>
       <input type="text" id="adminAccountName" placeholder="Valentine Ifedayo Ministries" style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 8px;">
       <button onclick="saveGivingSettings()" style="background: #1e3c72; color: white; border: none; padding: 12px 20px; border-radius: 8px; cursor: pointer; font-weight: bold; margin-top: 10px; width: 100%;">üíæ Save Payment Details</button>
      </div>
     </div>
     <hr style="margin: 30px 0; border: none; border-top: 2px solid #FFD700;">
     <div>
      <h4>‚òéÔ∏è Contact Information</h4>
      <div class="stream-url-inputs">
       <label>Contact Email:</label>
       <input type="email" id="adminContactEmail" placeholder="pastorvalentineifedayo@gmail.com" style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 8px;">
       <label>Contact Phone:</label>
       <input type="text" id="adminContactPhone" placeholder="+234 ..." style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 8px;">
       <label>Church Address (one item per line):</label>
       <textarea id="adminContactAddress" rows="3" placeholder="Ughele Junction, along Ado Road&#10;Akure, Ondo State&#10;Nigeria" style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 8px; font-family: inherit; resize: vertical;"></textarea>
       <button onclick="saveContactInfo()" style="background: #FFD700; color: #1e3c72; border: none; padding: 12px 20px; border-radius: 8px; cursor: pointer; font-weight: bold; margin-top: 10px; width: 100%;">üíæ Save Contact Info</button>
      </div>
     </div>
      <hr style="margin: 30px 0; border: none; border-top: 2px solid #FFD700;">
      <div>
       <h4>üìù About Us Content</h4>
       <div class="stream-url-inputs"><label>Church History:</label> <textarea id="aboutHistory" rows="4" placeholder="Enter church history..." style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 8px; font-family: inherit; resize: vertical;"></textarea> <label>Vision Statement:</label> <textarea id="aboutVision" rows="3" placeholder="Enter vision statement..." style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 8px; font-family: inherit; resize: vertical;"></textarea> <label>Mission Statement:</label> <textarea id="aboutMission" rows="4" placeholder="Enter mission statement..." style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 8px; font-family: inherit; resize: vertical;"></textarea> <label>Core Beliefs:</label> <textarea id="aboutBeliefs" rows="4" placeholder="Enter core beliefs..." style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 8px; font-family: inherit; resize: vertical;"></textarea> <label>Pastor Name:</label> <input type="text" id="pastorName" placeholder="Enter pastor name..." style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 8px;"> <label>Pastor Photo URL:</label> <input type="url" id="pastorPhotoUrl" placeholder="Enter pastor photo URL..." style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 8px;"> <label>Pastor Bio:</label> <textarea id="pastorBio" rows="4" placeholder="Enter pastor biography..." style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 8px; font-family: inherit; resize: vertical;"></textarea> <label>Pastor's Wife Name:</label> <input type="text" id="pastorWifeName" placeholder="Enter pastor's wife name..." style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 8px;"> <label>Pastor's Wife Photo URL:</label> <input type="url" id="pastorWifePhotoUrl" placeholder="Enter pastor's wife photo URL..." style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 8px;"> <label>Pastor's Wife Bio:</label> <textarea id="pastorWifeBio" rows="4" placeholder="Enter pastor's wife biography..." style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 8px; font-family: inherit; resize: vertical;"></textarea> <button onclick="updateAboutContent()" style="width: 100%; background: #FFD700; color: #1e3c72; border: none; padding: 15px; border-radius: 8px; cursor: pointer; font-weight: bold; margin-top: 10px;">üíæ Save About Content</button>
       </div>
      </div>
      <hr style="margin: 30px 0; border: none; border-top: 2px solid #FFD700;">
      <div>
       <h4>üìÖ Manage Upcoming Services</h4>
       <div style="background: #f9f9f9; padding: 20px; border-radius: 10px; margin: 20px 0;">
        <h5 style="margin-top: 0;">Add New Service/Event</h5>
        <form id="addEventForm" onsubmit="addUpcomingEvent(event)" style="display: grid; gap: 10px;"><input type="url" id="eventImageUrl" placeholder="Event Image URL (optional)" style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 8px;"> <input type="text" id="eventTitle" placeholder="Event Title *" required style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 8px;"> <input type="text" id="eventSchedule" placeholder="Schedule (e.g., Every Sunday) *" required style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 8px;"> <input type="text" id="eventTime" placeholder="Time (e.g., 9:00 AM) *" required style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 8px;"> <textarea id="eventDescription" placeholder="Description *" rows="2" required style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 8px; font-family: inherit; resize: vertical;"></textarea> <button type="submit" style="background: #1e3c72; color: white; border: none; padding: 12px; border-radius: 8px; cursor: pointer; font-weight: bold;">‚ûï Add Event</button>
        </form>
       </div>
       <div style="background: #f9f9f9; padding: 20px; border-radius: 10px;">
        <h5 style="margin-top: 0;">Current Events</h5>
        <div id="currentEventsList" style="display: grid; gap: 15px;">
         <p style="text-align: center; color: #666;">Loading events...</p>
        </div>
       </div>
      </div>
      <hr style="margin: 30px 0; border: none; border-top: 2px solid #FFD700;">
      <div>
       <h4>üî• Fire Night Countdown Settings</h4>
       <p style="color: #666; font-size: 14px;">Set a custom date and time for the next Fire Night countdown. Leave empty to use automatic (last Friday of month at 10 PM).</p>
       <div class="stream-url-inputs">
        <label>Custom Fire Night Date:</label>
        <input type="date" id="fireNightDate" style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 8px;">
        <label>Custom Fire Night Time:</label>
        <input type="time" id="fireNightTime" value="22:00" style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 8px;">
        <button onclick="saveFireNightSettings()" style="background: #1e3c72; color: white; border: none; padding: 12px 20px; border-radius: 8px; cursor: pointer; font-weight: bold; margin-top: 10px; width: 100%;">üíæ Save Fire Night Settings</button>
        <button onclick="clearFireNightSettings()" style="background: #6b7280; color: white; border: none; padding: 12px 20px; border-radius: 8px; cursor: pointer; font-weight: bold; margin-top: 5px; width: 100%;">üîÑ Reset to Automatic</button>
       </div>
      </div>
      <hr style="margin: 30px 0; border: none; border-top: 2px solid #FFD700;">
      <div>
       <h4>üñºÔ∏è Homepage Hero Background Images</h4>
       <p style="color: #666; font-size: 14px;">Add image URLs that will rotate on the homepage hero section. One URL per line.</p>
       <div class="stream-url-inputs">
        <label>Hero Background Image 1:</label>
        <input type="url" id="heroImage1" placeholder="https://example.com/image1.jpg" style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 8px;">
        <label>Hero Background Image 2:</label>
        <input type="url" id="heroImage2" placeholder="https://example.com/image2.jpg" style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 8px;">
        <label>Hero Background Image 3:</label>
        <input type="url" id="heroImage3" placeholder="https://example.com/image3.jpg" style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 8px;">
        <button onclick="saveHeroImages()" style="background: #1e3c72; color: white; border: none; padding: 12px 20px; border-radius: 8px; cursor: pointer; font-weight: bold; margin-top: 10px; width: 100%;">üíæ Save Hero Images</button>
       </div>
      </div>
      <hr style="margin: 30px 0; border: none; border-top: 2px solid #FFD700;">
      <div>
       <h4>üé¨ Glory Service Video</h4>
       <p style="color: #666; font-size: 14px;">Add a video URL to display on the homepage "Upcoming Services" section for Sunday Glory Service.</p>
       <div class="stream-url-inputs">
        <label>Video URL (YouTube, Google Drive, or direct video link):</label>
        <input type="url" id="gloryServiceVideo" placeholder="https://youtube.com/embed/..." style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 8px;">
        <p style="color: #888; font-size: 12px; margin-top: 5px;">For YouTube: Use embed URL format (https://www.youtube.com/embed/VIDEO_ID)</p>
        <button onclick="saveGloryServiceVideo()" style="background: #1e3c72; color: white; border: none; padding: 12px 20px; border-radius: 8px; cursor: pointer; font-weight: bold; margin-top: 10px; width: 100%;">üíæ Save Glory Service Video</button>
       </div>
      </div>
      <hr style="margin: 30px 0; border: none; border-top: 2px solid #FFD700;">
      <div>
       <h4>üôè Tuesday Counselling Service Video</h4>
       <p style="color: #666; font-size: 14px;">Add a video URL to display on the homepage for Tuesday Counselling Service.</p>
       <div class="stream-url-inputs">
        <label>Video URL (YouTube, Google Drive, or direct video link):</label>
        <input type="url" id="tuesdayCounsellingVideo" placeholder="https://youtube.com/embed/..." style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 8px;">
        <p style="color: #888; font-size: 12px; margin-top: 5px;">For YouTube: Use embed URL format (https://www.youtube.com/embed/VIDEO_ID)</p>
        <button onclick="saveTuesdayCounsellingVideo()" style="background: #1e3c72; color: white; border: none; padding: 12px 20px; border-radius: 8px; cursor: pointer; font-weight: bold; margin-top: 10px; width: 100%;">üíæ Save Tuesday Counselling Video</button>
       </div>
      </div>
      <hr style="margin: 30px 0; border: none; border-top: 2px solid #FFD700;">
      <div>
       <h4>ü¶∂ Footer Images</h4>
       <p style="color: #666; font-size: 14px;">Add image URLs to display in the website footer.</p>
       <div class="stream-url-inputs">
        <label>Footer Image 1:</label>
        <input type="url" id="footerImage1" placeholder="https://example.com/footer1.jpg" style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 8px;">
        <label>Footer Image 2:</label>
        <input type="url" id="footerImage2" placeholder="https://example.com/footer2.jpg" style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 8px;">
        <button onclick="saveFooterImages()" style="background: #1e3c72; color: white; border: none; padding: 12px 20px; border-radius: 8px; cursor: pointer; font-weight: bold; margin-top: 10px; width: 100%;">üíæ Save Footer Images</button>
       </div>
      </div>
     </div>
    </div>
   </div>
  </div><!-- Footer -->
  <footer>
   <div id="footerImagesContainer" style="display: flex; gap: 20px; justify-content: center; margin-bottom: 20px; flex-wrap: wrap;">
    <img id="footerImg1" src="https://lh3.googleusercontent.com/d/1NvHVmaJMBA4rucIu6fbE4PIoMLobhmsg" alt="VIM Ministry" style="height: 280px; object-fit: contain; border-radius: 8px;" onerror="this.style.display='none';">
    <img id="footerImg2" src="https://lh3.googleusercontent.com/d/18PUaKOEJf7SQvbcDsr8m82l6FxqIcXV_" alt="VIM Ministry" style="height: 280px; object-fit: contain; border-radius: 8px;" onerror="this.style.display='none';">
   </div>
  <p><strong>Vibrant Impact Ministries (VIM)</strong></p>
  <p>Ughele Junction, Ado Road, Akure, Ondo State, Nigeria</p>
  <p id="footerContactLine">Email: pastorvalentineifedayo@gmail.com | Phone: +234 (Contact for appointment)</p>
  <p>¬© 2024 Vibrant Impact Ministries. All Rights Reserved.</p>
   <p style="margin-top: 15px; font-style: italic;">"Raising Vibrant Believers for Kingdom Impact"</p>
  </footer><!-- Firebase Scripts -->
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-storage-compat.js"></script>
  <script>
    // Firebase Configuration
    const firebaseConfig = {
      apiKey: "AIzaSyBYwJ4PjGyycAzUS7iyTrTRpIUcKLAvPVE",
      authDomain: "vim-p-cc4be.firebaseapp.com",
      projectId: "vim-p-cc4be",
      storageBucket: "vim-p-cc4be.firebasestorage.app",
      messagingSenderId: "444991156114",
      appId: "1:444991156114:web:a6c5425cf3a9aa91369b4b",
      measurementId: "G-V0BVRB9WRR"
    };

    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();
    const storage = firebase.storage();

    // Admin emails
    const ADMIN_EMAILS = ['eiweh123@gmail.com', 'vibrantchannel286@gmail.com'];

    // Current user state
    let currentUser = null;
    let isAdmin = false;
    let mediaItems = [];
    let departments = [];
    let upcomingEvents = [];
    let partnershipRegistrations = [];
    let partnershipListener = null; // For real-time listener
    let prayerRequests = [];
    const DEFAULT_GIVING = {
      paystackUrl: 'https://paystack.com/pay/vibrantimpact',
      paypalUrl: 'https://www.paypal.me/Funmzyanie',
      bankName: 'UBA (United Bank for Africa)',
      accountNumber: '1025522432',
      accountName: 'Valentine Ifedayo Ministries'
    };
    const DEFAULT_CONTACT = {
      email: 'pastorvalentineifedayo@gmail.com',
      phone: '+234 (Contact for appointment)',
      address: 'Ughele Junction, along Ado Road\nAkure, Ondo State\nNigeria'
    };
    let givingSettings = { ...DEFAULT_GIVING };
    let contactSettings = { ...DEFAULT_CONTACT };

    // Toggle dropdown menu
    function toggleMenu() {
      const dropdownMenu = document.getElementById('dropdownMenu');
      dropdownMenu.classList.toggle('show');
    }

    // Close menu when clicking outside
    document.addEventListener('click', function(event) {
      const nav = document.querySelector('nav');
      const dropdownMenu = document.getElementById('dropdownMenu');
      if (dropdownMenu && !nav.contains(event.target)) {
        dropdownMenu.classList.remove('show');
      }
    });

    // Navigation
    function navigateTo(pageId) {
      // Hide dropdown menu
      const dropdownMenu = document.getElementById('dropdownMenu');
      if (dropdownMenu) {
        dropdownMenu.classList.remove('show');
      }
      
      // Hide all pages
      document.querySelectorAll('.page').forEach(page => {
        page.classList.remove('active');
      });
      
      // Remove active class from all nav buttons
      document.querySelectorAll('.dropdown-menu button').forEach(btn => {
        btn.classList.remove('active');
      });
      
      // Show selected page
      document.getElementById(pageId).classList.add('active');
      
      // Add active class to clicked button
      if (event && event.target) {
        event.target.classList.add('active');
      }
      
      // Update user section for media page
      if (pageId === 'media') {
        updateMediaUserSection();
      }
      
      // Update user section for departments page
      if (pageId === 'departments') {
        updateDepartmentsUserSection();
        loadDepartments();
      }
      
      // Load account info for account page
      if (pageId === 'account') {
        if (currentUser) {
          loadAccountInfo();
        } else {
          navigateTo('auth');
          showToast('‚ö†Ô∏è Please login to view your account.', 'error');
          return;
        }
      }
      
      // Scroll to top
      window.scrollTo(0, 0);
    }

    // Toast notification
    function showToast(message, type = 'success') {
      const toast = document.createElement('div');
      toast.className = `toast ${type}`;
      toast.textContent = message;
      document.body.appendChild(toast);
      
      setTimeout(() => {
        toast.remove();
      }, 3000);
    }

    // Auth state observer
    auth.onAuthStateChanged((user) => {
      currentUser = user;
      isAdmin = user && ADMIN_EMAILS.includes(user.email);
      
      updateAuthUI();
      updateMediaUserSection();
      updateDepartmentsUserSection();
      updateNavButtons();
      loadMediaItems();
      loadDepartments();
      if (isAdmin) {
        loadPrayerRequests();
        loadPartnershipRegistrations();
        setupPartnershipListener();
        requestNotificationPermission();
      } else {
        // Remove listener when admin logs out
        if (partnershipListener) {
          partnershipListener();
          partnershipListener = null;
        }
      }
      
      // Show/hide admin settings
      const adminSettings = document.getElementById('adminSettings');
      if (adminSettings) {
        if (isAdmin) {
          adminSettings.classList.add('show');
          loadAboutContent();
          loadSavedSocialLinks();
          loadGivingSettings();
          loadContactInfo();
        } else {
          adminSettings.classList.remove('show');
        }
      }
      
      // Load account info if on account page
      if (user) {
        loadAccountInfo();
      }
    });

    // Update navigation buttons based on auth state
    function updateNavButtons() {
      const authNavBtn = document.getElementById('authNavBtn');
      const accountNavBtn = document.getElementById('accountNavBtn');
      const adminSettingsNavBtn = document.getElementById('adminSettingsNavBtn');
      
      if (currentUser) {
        authNavBtn.style.display = 'none';
        accountNavBtn.style.display = 'block';
        
        // Show admin settings button only for admins
        if (isAdmin) {
          adminSettingsNavBtn.style.display = 'block';
        } else {
          adminSettingsNavBtn.style.display = 'none';
        }
      } else {
        authNavBtn.style.display = 'block';
        accountNavBtn.style.display = 'none';
        adminSettingsNavBtn.style.display = 'none';
      }
    }

    // Load account information
    async function loadAccountInfo() {
      if (!currentUser) return;
      
      const accountUserInfo = document.getElementById('accountUserInfo');
      
      try {
        const userDoc = await db.collection('users').doc(currentUser.uid).get();
        const userData = userDoc.data();
        
        if (userData) {
          accountUserInfo.innerHTML = `
            <p><strong>Name:</strong> ${userData.name || 'Not set'}</p>
            <p><strong>Email:</strong> ${currentUser.email}</p>
            <p><strong>Phone:</strong> ${userData.phone || 'Not set'}</p>
            <p><strong>Member Since:</strong> ${userData.createdAt ? new Date(userData.createdAt.toDate()).toLocaleDateString() : 'N/A'}</p>
            ${isAdmin ? '<p style="color: #FFD700; font-weight: bold; margin-top: 15px;">‚≠ê ADMIN ACCOUNT</p>' : '<p style="color: #1e3c72; font-weight: bold; margin-top: 15px;">‚úÖ MEMBER ACCOUNT</p>'}
          `;
          
          // Pre-fill edit form
          document.getElementById('editName').value = userData.name || '';
          document.getElementById('editPhone').value = userData.phone || '';
          document.getElementById('editEmail').value = currentUser.email;
        } else {
          accountUserInfo.innerHTML = `
            <p><strong>Email:</strong> ${currentUser.email}</p>
            <p style="color: #666;">Account details not found. Please update your information below.</p>
            ${isAdmin ? '<p style="color: #FFD700; font-weight: bold; margin-top: 15px;">‚≠ê ADMIN ACCOUNT</p>' : '<p style="color: #1e3c72; font-weight: bold; margin-top: 15px;">‚úÖ MEMBER ACCOUNT</p>'}
          `;
          
          document.getElementById('editEmail').value = currentUser.email;
        }
      } catch (error) {
        console.error('Error loading account info:', error);
        accountUserInfo.innerHTML = `
          <p><strong>Email:</strong> ${currentUser.email}</p>
          <p style="color: #dc2626;">Failed to load account details. Please try again.</p>
        `;
      }
    }

    // Update account details
    async function updateAccountDetails(event) {
      event.preventDefault();
      
      if (!currentUser) {
        showToast('Please login first.', 'error');
        return;
      }
      
      const name = document.getElementById('editName').value;
      const phone = document.getElementById('editPhone').value;
      
      try {
        await db.collection('users').doc(currentUser.uid).set({
          name: name,
          email: currentUser.email,
          phone: phone,
          updatedAt: firebase.firestore.FieldValue.serverTimestamp()
        }, { merge: true });
        
        showToast('‚úÖ Account details updated successfully!', 'success');
        loadAccountInfo();
      } catch (error) {
        showToast('‚ùå Update failed: ' + error.message, 'error');
      }
    }

    // Change password
    async function changePassword(event) {
      event.preventDefault();
      
      if (!currentUser) {
        showToast('‚ùå Please login first.', 'error');
        return;
      }
      
      const currentPassword = document.getElementById('currentPassword').value;
      const newPassword = document.getElementById('newPassword').value;
      const confirmPassword = document.getElementById('confirmNewPassword').value;
      
      if (newPassword !== confirmPassword) {
        showToast('‚ùå New passwords do not match!', 'error');
        return;
      }
      
      try {
        // Re-authenticate user
        const credential = firebase.auth.EmailAuthProvider.credential(
          currentUser.email,
          currentPassword
        );
        
        await currentUser.reauthenticateWithCredential(credential);
        
        // Update password
        await currentUser.updatePassword(newPassword);
        
        showToast('‚úÖ Password changed successfully!', 'success');
        document.getElementById('changePasswordForm').reset();
      } catch (error) {
        if (error.code === 'auth/wrong-password') {
          showToast('‚ùå Current password is incorrect.', 'error');
        } else {
          showToast('‚ùå Password change failed: ' + error.message, 'error');
        }
      }
    }

    // Update auth UI
    function updateAuthUI() {
      const authForms = document.getElementById('authForms');
      const userInfoSection = document.getElementById('userInfoSection');
      const userEmail = document.getElementById('userEmail');
      const adminBadge = document.getElementById('adminBadge');
      
      if (currentUser) {
        authForms.style.display = 'none';
        userInfoSection.style.display = 'block';
        userEmail.textContent = currentUser.email;
        
        if (isAdmin) {
          adminBadge.style.display = 'block';
        } else {
          adminBadge.style.display = 'none';
        }
      } else {
        authForms.style.display = 'block';
        userInfoSection.style.display = 'none';
      }
    }

    // Toggle auth forms
    function toggleAuthForm(formType) {
      const loginSection = document.getElementById('loginSection');
      const signupSection = document.getElementById('signupSection');
      
      if (formType === 'login') {
        loginSection.style.display = 'block';
        signupSection.style.display = 'none';
      } else {
        loginSection.style.display = 'none';
        signupSection.style.display = 'block';
      }
    }

    // Login user
    async function loginUser(event) {
      event.preventDefault();
      
      const email = document.getElementById('loginEmail').value;
      const password = document.getElementById('loginPassword').value;
      
      try {
        await auth.signInWithEmailAndPassword(email, password);
        showToast('‚úÖ Login successful!', 'success');
        document.getElementById('loginForm').reset();
      } catch (error) {
        showToast('‚ùå Login failed: ' + error.message, 'error');
      }
    }

    // Signup user
    async function signupUser(event) {
      event.preventDefault();
      
      const name = document.getElementById('signupName').value;
      const email = document.getElementById('signupEmail').value;
      const password = document.getElementById('signupPassword').value;
      const phone = document.getElementById('signupPhone').value;
      
      try {
        const userCredential = await auth.createUserWithEmailAndPassword(email, password);
        
        // Save additional user info to Firestore
        await db.collection('users').doc(userCredential.user.uid).set({
          name: name,
          email: email,
          phone: phone,
          createdAt: firebase.firestore.FieldValue.serverTimestamp()
        });
        
        showToast('‚úÖ Account created successfully!', 'success');
        document.getElementById('signupForm').reset();
        toggleAuthForm('login');
      } catch (error) {
        showToast('‚ùå Signup failed: ' + error.message, 'error');
      }
    }

    // Logout user
    async function logoutUser() {
      try {
        await auth.signOut();
        showToast('‚úÖ Logged out successfully!', 'success');
      } catch (error) {
        showToast('‚ùå Logout failed: ' + error.message, 'error');
      }
    }

    // Submit partnership form
    async function submitPartnership(event) {
      event.preventDefault();
      
      const name = document.getElementById('partnerName').value;
      const email = document.getElementById('partnerEmail').value;
      const phone = document.getElementById('partnerPhone').value;
      const type = document.getElementById('partnershipType').value;
      
      try {
        await db.collection('partners').add({
          name: name,
          email: email,
          phone: phone,
          partnershipType: type,
          submittedAt: firebase.firestore.FieldValue.serverTimestamp()
        });
        
        showToast('‚úÖ Partnership registration submitted! We will contact you soon.', 'success');
        document.getElementById('partnershipForm').reset();
      } catch (error) {
        showToast('‚ùå Submission failed. Please try again.', 'error');
      }
    }

    // Submit prayer request
    async function submitPrayerRequest(event) {
      event.preventDefault();
      
      const name = document.getElementById('prayerName').value;
      const email = document.getElementById('prayerEmail').value;
      const phone = document.getElementById('prayerPhone').value;
      const request = document.getElementById('prayerRequest').value;
      
      try {
        await db.collection('prayerRequests').add({
          name: name,
          email: email,
          phone: phone,
          request: request,
          submittedAt: firebase.firestore.FieldValue.serverTimestamp()
        });
        
        showToast('üôè Prayer request submitted! Our team will pray for you.', 'success');
        document.getElementById('prayerForm').reset();
      } catch (error) {
        showToast('‚ùå Submission failed. Please try again.', 'error');
      }
    }

    // Update media user section
    function updateMediaUserSection() {
      const mediaUserSection = document.getElementById('mediaUserSection');
      
      if (currentUser) {
        mediaUserSection.innerHTML = `
          <div class="user-info">
            <p><strong>Logged in as:</strong> ${currentUser.email}</p>
            ${isAdmin ? '<p style="color: #FFD700; font-weight: bold;">‚≠ê ADMIN ACCESS - You can upload and delete media</p>' : '<p>‚úÖ You can download media</p>'}
          </div>
        `;
      } else {
        mediaUserSection.innerHTML = `
          <div class="user-info">
            <p>Please <a onclick="navigateTo('auth')" style="color: #1e3c72; cursor: pointer; text-decoration: underline; font-weight: bold;">login</a> to download media or upload content (admin only)</p>
          </div>
        `;
      }
      
      // Show/hide admin upload section
      const adminUploadSection = document.getElementById('adminUploadSection');
      if (isAdmin) {
        adminUploadSection.classList.add('show');
      } else {
        adminUploadSection.classList.remove('show');
      }
    }

    // Upload media (admin only with file upload support)
    async function uploadMedia(event) {
      event.preventDefault();
      
      if (!isAdmin) {
        showToast('‚ùå Only admins can upload media.', 'error');
        return;
      }
      
      const type = document.getElementById('mediaType').value;
      const title = document.getElementById('mediaTitle').value;
      const description = document.getElementById('mediaDescription').value;
      const category = document.getElementById('mediaCategory').value;
      const language = document.getElementById('mediaLanguage').value;
      const urlInput = document.getElementById('mediaUrl').value;
      const fileInput = document.getElementById('mediaFiles');
      const files = fileInput.files;
      
      const loadingSpinner = document.getElementById('mediaLoading');
      const progressBar = document.getElementById('uploadProgress');
      const progressBarFill = document.getElementById('uploadProgressBar');
      const uploadStatus = document.getElementById('uploadStatus');
      
      loadingSpinner.classList.add('show');
      
      try {
        // Check if files are selected for upload
        if (files.length > 0) {
          progressBar.classList.add('show');
          uploadStatus.classList.add('show');
          
          // Upload all files in parallel for speed
          const uploadPromises = Array.from(files).map(async (file, i) => {
            const fileType = file.type.startsWith('image/') ? 'image' : 'video';
            
            // Create a storage reference
            const storageRef = storage.ref();
            const fileRef = storageRef.child(`media/${Date.now()}_${i}_${file.name}`);
            
            // Upload file (no progress monitoring for speed)
            await fileRef.put(file);
            
            // Get download URL
            const downloadURL = await fileRef.getDownloadURL();
            
            // Save to Firestore
            await db.collection('media').add({
              type: fileType,
              title: files.length > 1 ? `${title} (${i + 1})` : title,
              description: description,
              category: category,
              language: language,
              imageUrl: fileType === 'image' ? downloadURL : '',
              videoUrl: fileType === 'video' ? downloadURL : '',
              uploadedBy: currentUser.email,
              uploadedAt: firebase.firestore.FieldValue.serverTimestamp()
            });
            
            return i + 1;
          });
          
          uploadStatus.textContent = `Uploading ${files.length} file(s)...`;
          progressBarFill.style.width = '50%';
          
          // Wait for all uploads to complete
          await Promise.all(uploadPromises);
          
          progressBarFill.style.width = '100%';
          uploadStatus.textContent = `üéâ All ${files.length} file(s) uploaded successfully!`;
          showToast(`‚úÖ ${files.length} file(s) uploaded!`, 'success');
          
          setTimeout(() => {
            uploadStatus.classList.remove('show');
          }, 2000);
        } else if (urlInput) {
          // Upload via URL (original functionality)
          await db.collection('media').add({
            type: type,
            title: title,
            description: description,
            category: category,
            language: language,
            imageUrl: type === 'image' ? urlInput : '',
            videoUrl: type === 'video' ? urlInput : '',
            uploadedBy: currentUser.email,
            uploadedAt: firebase.firestore.FieldValue.serverTimestamp()
          });
          
          showToast('‚úÖ Media uploaded successfully!', 'success');
        } else {
          showToast('Please select files or enter a URL.', 'error');
          loadingSpinner.classList.remove('show');
          return;
        }
        
        document.getElementById('uploadForm').reset();
        progressBar.classList.remove('show');
        progressBarFill.style.width = '0%';
        loadMediaItems();
      } catch (error) {
        showToast('‚ùå Upload failed: ' + error.message, 'error');
        uploadStatus.textContent = 'Upload failed. Please try again.';
        setTimeout(() => {
          uploadStatus.classList.remove('show');
        }, 3000);
      } finally {
        loadingSpinner.classList.remove('show');
      }
    }

    // Load media items
    async function loadMediaItems() {
      const mediaGallery = document.getElementById('mediaGallery');
      const loadingSpinner = document.getElementById('mediaLoading');
      
      loadingSpinner.classList.add('show');
      
      try {
        const snapshot = await db.collection('media').orderBy('uploadedAt', 'desc').get();
        mediaItems = [];
        
        snapshot.forEach(doc => {
          mediaItems.push({ id: doc.id, ...doc.data() });
        });
        
        renderMediaGallery();
      } catch (error) {
        console.error('Error loading media:', error);
        mediaGallery.innerHTML = '<p style="text-align: center; color: #666;">No media available yet. Admins can upload content.</p>';
      } finally {
        loadingSpinner.classList.remove('show');
      }
    }

    // Render media gallery
    function renderMediaGallery() {
      const mediaGallery = document.getElementById('mediaGallery');
      
      if (mediaItems.length === 0) {
        mediaGallery.innerHTML = '<p style="text-align: center; color: #666;">No media available yet. Admins can upload content.</p>';
        return;
      }
      
      mediaGallery.innerHTML = mediaItems.map(item => `
        <div class="media-item">
          ${item.type === 'image' ? 
            `<img src="${item.imageUrl}" alt="${item.title}" onerror="this.src=''; this.alt='Image failed to load'; this.style.display='none';">` :
            (item.videoUrl.includes('youtube.com') || item.videoUrl.includes('youtu.be') ?
              `<div style="width: 100%; height: 200px; position: relative;">
                <iframe 
                  width="100%" 
                  height="200" 
                  src="${item.videoUrl.replace('watch?v=', 'embed/').replace('youtu.be/', 'youtube.com/embed/')}" 
                  frameborder="0" 
                  allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                  allowfullscreen
                  style="border-radius: 0;">
                </iframe>
              </div>` :
              (item.videoUrl.includes('facebook.com') || item.videoUrl.includes('fb.watch') || item.videoUrl.includes('fb.com') ?
                `<div style="width: 100%; height: 200px; position: relative;">
                  <iframe 
                    src="https://www.facebook.com/plugins/video.php?href=${encodeURIComponent(item.videoUrl)}&width=500&show_text=false&appId" 
                    width="100%" 
                    height="200" 
                    style="border:none;overflow:hidden" 
                    scrolling="no" 
                    frameborder="0" 
                    allowfullscreen="true" 
                    allow="autoplay; clipboard-write; encrypted-media; picture-in-picture; web-share">
                  </iframe>
                </div>` :
                `<div style="width: 100%; height: 200px; background: #000; display: flex; align-items: center; justify-content: center; position: relative;">
                  <video 
                    id="video_${item.id}"
                    controls 
                    preload="metadata" 
                    playsinline 
                    webkit-playsinline 
                    style="width: 100%; height: 100%; object-fit: contain;"
                    onloadeddata="this.style.display='block'; this.nextElementSibling.style.display='none';"
                    onerror="handleVideoError(this, '${item.videoUrl}', '${item.title}')">
                    <source src="${item.videoUrl}" type="video/mp4">
                    <source src="${item.videoUrl.replace('.mp4', '.webm')}" type="video/webm">
                    <source src="${item.videoUrl.replace('.mp4', '.mov')}" type="video/quicktime">
                  </video>
                  <div style="position: absolute; color: white; text-align: center; padding: 20px; display: none;" id="error_${item.id}">
                    <p style="margin: 10px 0;">üìπ Video Preview Unavailable</p>
                    <a href="${item.videoUrl}" download target="_blank" rel="noopener noreferrer" style="color: #FFD700; text-decoration: underline; font-weight: bold;">‚¨áÔ∏è Download Video</a>
                  </div>
                </div>`
              )
            )
          }
          <div class="media-info">
            <h4>${item.title}</h4>
            <p>${item.description || 'No description'}</p>
            <p><strong>Category:</strong> ${item.category}</p>
            <p><strong>Language:</strong> ${item.language || 'Not specified'}</p>
            <div class="media-actions">
              ${currentUser ? `<button class="download-btn" onclick="downloadMedia('${item.id}')">‚¨áÔ∏è Download</button>` : ''}
              ${isAdmin ? `<button class="delete-btn show" onclick="deleteMedia('${item.id}')">üóëÔ∏è Delete</button>` : ''}
            </div>
          </div>
        </div>
      `).join('');
    }

    // Download media
    function downloadMedia(mediaId) {
      if (!currentUser) {
        showToast('‚ùå Please login to download media.', 'error');
        return;
      }
      
      const item = mediaItems.find(m => m.id === mediaId);
      if (!item) return;
      
      const url = item.type === 'image' ? item.imageUrl : item.videoUrl;
      window.open(url, '_blank', 'noopener,noreferrer');
      showToast('‚úÖ Opening download link...', 'success');
    }

    // Delete media (admin only)
    async function deleteMedia(mediaId) {
      if (!isAdmin) {
        showToast('‚ùå Only admins can delete media.', 'error');
        return;
      }
      
      // Inline confirmation instead of browser dialog
      const deleteButtons = document.querySelectorAll(`[onclick*="deleteMedia('${mediaId}')"]`);
      let mediaItem = null;
      
      for (let btn of deleteButtons) {
        const item = btn.closest('.media-item');
        if (item) {
          mediaItem = item;
          break;
        }
      }
      
      if (!mediaItem) {
        showToast('‚ùå Could not find media item.', 'error');
        return;
      }
      
      const originalHTML = mediaItem.innerHTML;
      
      mediaItem.innerHTML = `
        <div style="padding: 40px; text-align: center;">
          <p style="margin: 20px 0; font-weight: bold;">Delete this media?</p>
          <button onclick="confirmDelete('${mediaId}')" style="background: #dc2626; color: white; padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; margin: 5px;">Yes, Delete</button>
          <button onclick="loadMediaItems()" style="background: #6b7280; color: white; padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; margin: 5px;">Cancel</button>
        </div>
      `;
    }

    async function confirmDelete(mediaId) {
      try {
        const item = mediaItems.find(m => m.id === mediaId);
        
        // Delete from Storage if it's an uploaded file (not YouTube or external URL)
        if (item) {
          const url = item.imageUrl || item.videoUrl;
          if (url && url.includes('firebasestorage')) {
            try {
              const fileRef = storage.refFromURL(url);
              await fileRef.delete();
            } catch (storageError) {
              console.log('Storage deletion skipped (file may not exist):', storageError);
            }
          }
        }
        
        // Delete from Firestore (this is the main deletion)
        await db.collection('media').doc(mediaId).delete();
        showToast('‚úÖ Media deleted successfully!', 'success');
        loadMediaItems();
      } catch (error) {
        console.error('Delete error:', error);
        showToast('‚ùå Delete failed: ' + error.message, 'error');
        loadMediaItems();
      }
    }

    // Save live stream URL
    function saveLiveStreamUrl(platform, url) {
      localStorage.setItem(`vim${platform.charAt(0).toUpperCase() + platform.slice(1)}LiveUrl`, url);
      showToast(`‚úÖ ${platform.charAt(0).toUpperCase() + platform.slice(1)} live URL saved!`, 'success');
    }

    // Update logo
    function updateLogo() {
      if (!isAdmin) {
        showToast('‚ùå Only admins can update the logo.', 'error');
        return;
      }

      const logoUrl = document.getElementById('logoUrl').value.trim();
      
      if (!logoUrl) {
        showToast('Please enter a logo URL.', 'error');
        return;
      }

      // Save to localStorage
      localStorage.setItem('vimLogoUrl', logoUrl);

      // Update all logo displays
      updateLogoDisplay();

      showToast('‚úÖ Logo updated successfully!', 'success');
    }

    // Update logo display across the site
    function updateLogoDisplay() {
      const logoUrl = localStorage.getItem('vimLogoUrl') || 'https://lh3.googleusercontent.com/d/1vV6tbXgw-7RB60wnzL-nGUQLz3xXO8S3';
      
      // Update header logo
      const headerLogo = document.querySelector('.logo-section .logo');
      if (headerLogo) {
        headerLogo.innerHTML = `<img src="${logoUrl}" alt="VIM Logo" style="width: 100%; height: 100%; object-fit: contain;" onerror="this.parentElement.innerHTML='VIM'; this.parentElement.style.fontSize='32px'; this.parentElement.style.display='flex'; this.parentElement.style.alignItems='center'; this.parentElement.style.justifyContent='center';">`;
      }

      // Update admin preview logo
      const adminPreview = document.getElementById('adminLogoPreview');
      if (adminPreview) {
        adminPreview.innerHTML = `<img src="${logoUrl}" alt="VIM Logo" style="width: 100%; height: 100%; object-fit: contain;" onerror="this.parentElement.innerHTML='üî•'; this.parentElement.style.fontSize='32px';">`;
      }
    }

    // Save social media link
    function saveSocialLink(platform, url) {
      if (!isAdmin) {
        showToast('‚ùå Only admins can update social links.', 'error');
        return;
      }

      localStorage.setItem(`vim${platform.charAt(0).toUpperCase() + platform.slice(1)}SocialUrl`, url);
      updateSocialLinks();
      showToast(`‚úÖ ${platform.charAt(0).toUpperCase() + platform.slice(1)} link saved!`, 'success');
    }

    // Update social links display
    function updateSocialLinks() {
      const facebookUrl = localStorage.getItem('vimFacebookSocialUrl') || 'https://facebook.com/VibrantImpactMinistries';
      const youtubeUrl = localStorage.getItem('vimYoutubeSocialUrl') || 'https://youtube.com/@ProphetValentineIfedayoChannel';
      const tiktokUrl = localStorage.getItem('vimTiktokSocialUrl') || 'https://tiktok.com/@prophet_valentineifedayo';
      const twitchUrl = localStorage.getItem('vimTwitchSocialUrl') || 'https://twitch.tv/vibrantimpactministries';
      const whatsappUrl = localStorage.getItem('vimWhatsappSocialUrl') || 'https://chat.whatsapp.com/your-group-link';

      // Update all social link sections
      document.querySelectorAll('.social-links').forEach(container => {
        container.innerHTML = `
          <a href="${facebookUrl}" target="_blank" rel="noopener noreferrer" class="social-btn facebook" title="Facebook">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="white"><path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/></svg>
          </a>
          <a href="${youtubeUrl}" target="_blank" rel="noopener noreferrer" class="social-btn youtube" title="YouTube">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="white"><path d="M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"/></svg>
          </a>
          <a href="${tiktokUrl}" target="_blank" rel="noopener noreferrer" class="social-btn tiktok" title="TikTok">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="white"><path d="M19.59 6.69a4.83 4.83 0 0 1-3.77-4.25V2h-3.45v13.67a2.89 2.89 0 0 1-5.2 1.74 2.89 2.89 0 0 1 2.31-4.64 2.93 2.93 0 0 1 .88.13V9.4a6.84 6.84 0 0 0-1-.05A6.33 6.33 0 0 0 5 20.1a6.34 6.34 0 0 0 10.86-4.43v-7a8.16 8.16 0 0 0 4.77 1.52v-3.4a4.85 4.85 0 0 1-1-.1z"/></svg>
          </a>
          <a href="${twitchUrl}" target="_blank" rel="noopener noreferrer" class="social-btn twitch" title="Twitch">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="white"><path d="M11.571 4.714h1.715v5.143H11.57zm4.715 0H18v5.143h-1.714zM6 0L1.714 4.286v15.428h5.143V24l4.286-4.286h3.428L22.286 12V0zm14.571 11.143l-3.428 3.428h-3.429l-3 3v-3H6.857V1.714h13.714Z"/></svg>
          </a>
          <a href="${whatsappUrl}" target="_blank" rel="noopener noreferrer" class="social-btn whatsapp" title="WhatsApp Group">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="white"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.890-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z"/></svg>
          </a>
        `;
      });
    }

    // Load prayer requests (admin only)
    async function loadPrayerRequests() {
      if (!isAdmin) {
        showToast('‚ùå Only admins can view prayer requests.', 'error');
        return;
      }

      const listEl = document.getElementById('prayerRequestsList');
      if (!listEl) return;

      listEl.innerHTML = '<p style="color: #666; text-align: center;">Loading...</p>';

      try {
        const snapshot = await db.collection('prayerRequests').orderBy('submittedAt', 'desc').limit(100).get();
        prayerRequests = [];
        snapshot.forEach(doc => {
          prayerRequests.push({ id: doc.id, ...doc.data() });
        });
        renderPrayerRequests();
      } catch (error) {
        console.error('Error loading prayer requests:', error);
        listEl.innerHTML = '<p style="color: #dc2626; text-align: center;">Failed to load prayer requests.</p>';
      }
    }

    function renderPrayerRequests() {
      const listEl = document.getElementById('prayerRequestsList');
      if (!listEl) return;

      if (!isAdmin) {
        listEl.innerHTML = '<p style="color: #dc2626; text-align: center;">Admin access required.</p>';
        return;
      }

      if (prayerRequests.length === 0) {
        listEl.innerHTML = '<p style="color: #666; text-align: center;">No prayer requests yet.</p>';
        return;
      }

      listEl.innerHTML = prayerRequests.map(req => {
        const submittedAt = req.submittedAt?.toDate ? new Date(req.submittedAt.toDate()) : null;
        const submittedText = submittedAt ? submittedAt.toLocaleString() : 'Unknown';
        return `
          <div style="background: white; border: 1px solid #ddd; border-radius: 8px; padding: 12px;">
            <div style="display: flex; justify-content: space-between; gap: 10px; flex-wrap: wrap;">
              <div>
                <p style="margin: 0; font-weight: bold; color: #1e3c72;">${req.name || 'Anonymous'}</p>
                <p style="margin: 2px 0; color: #555;">${req.email || 'No email'} | ${req.phone || 'No phone'}</p>
                <p style="margin: 2px 0; color: #888; font-size: 12px;">${submittedText}</p>
              </div>
              <button onclick="deletePrayerRequest('${req.id}')" style="background: #dc2626; color: white; border: none; padding: 8px 12px; border-radius: 6px; cursor: pointer; font-weight: bold; height: 36px;">üóëÔ∏è Delete</button>
            </div>
            <p style="margin-top: 8px; white-space: pre-wrap; color: #333;">${req.request || ''}</p>
          </div>
        `;
      }).join('');
    }

    async function deletePrayerRequest(requestId) {
      if (!isAdmin) {
        showToast('‚ùå Only admins can delete prayer requests.', 'error');
        return;
      }

      try {
        await db.collection('prayerRequests').doc(requestId).delete();
        prayerRequests = prayerRequests.filter(r => r.id !== requestId);
        renderPrayerRequests();
        showToast('‚úÖ Prayer request deleted.', 'success');
      } catch (error) {
        console.error('Delete failed:', error);
        showToast('‚ùå Failed to delete: ' + error.message, 'error');
      }
    }

    // Request notification permission
    async function requestNotificationPermission() {
      if ('Notification' in window && Notification.permission === 'default') {
        await Notification.requestPermission();
      }
    }

    // Show browser notification
    function showNotification(title, body, icon = 'üîî') {
      if ('Notification' in window && Notification.permission === 'granted') {
        new Notification(title, {
          body: body,
          icon: icon,
          badge: icon,
          tag: 'partnership-registration',
          requireInteraction: false
        });
      }
    }

    // Load partnership registrations (admin only)
    async function loadPartnershipRegistrations() {
      if (!isAdmin) {
        showToast('‚ùå Only admins can view partnership registrations.', 'error');
        return;
      }

      const listEl = document.getElementById('partnershipRegistrationsList');
      if (!listEl) return;

      listEl.innerHTML = '<p style="color: #666; text-align: center;">Loading...</p>';

      try {
        const snapshot = await db.collection('partners').orderBy('submittedAt', 'desc').limit(500).get();
        partnershipRegistrations = [];
        snapshot.forEach(doc => {
          partnershipRegistrations.push({ id: doc.id, ...doc.data() });
        });
        renderPartnershipRegistrations();
        
        // Load WhatsApp link for emailing
        const whatsappLink = localStorage.getItem('vimWhatsappLinkForEmail') || '';
        const whatsappInput = document.getElementById('whatsappLinkForEmail');
        if (whatsappInput) whatsappInput.value = whatsappLink;
      } catch (error) {
        console.error('Error loading partnership registrations:', error);
        listEl.innerHTML = '<p style="color: #dc2626; text-align: center;">Failed to load registrations.</p>';
      }
    }

    function renderPartnershipRegistrations() {
      const listEl = document.getElementById('partnershipRegistrationsList');
      if (!listEl) return;

      if (!isAdmin) {
        listEl.innerHTML = '<p style="color: #dc2626; text-align: center;">Admin access required.</p>';
        return;
      }

      if (partnershipRegistrations.length === 0) {
        listEl.innerHTML = '<p style="color: #666; text-align: center;">No partnership registrations yet.</p>';
        return;
      }

      listEl.innerHTML = partnershipRegistrations.map(partner => {
        const submittedAt = partner.submittedAt?.toDate ? new Date(partner.submittedAt.toDate()) : null;
        const submittedText = submittedAt ? submittedAt.toLocaleString() : 'Unknown';
        return `
          <div style="background: white; border: 1px solid #ddd; border-radius: 8px; padding: 15px;">
            <div style="display: flex; justify-content: space-between; gap: 10px; flex-wrap: wrap; margin-bottom: 10px;">
              <div style="flex: 1;">
                <p style="margin: 0; font-weight: bold; color: #1e3c72; font-size: 16px;">${partner.name || 'No name'}</p>
                <p style="margin: 4px 0; color: #555;">üìß ${partner.email || 'No email'}</p>
                <p style="margin: 4px 0; color: #555;">üì± ${partner.phone || 'No phone'}</p>
                <p style="margin: 4px 0; color: #888; font-size: 12px;">‚è∞ ${submittedText}</p>
                <p style="margin: 4px 0;"><strong>Type:</strong> <span style="color: #1e3c72;">${partner.partnershipType || 'Not specified'}</span></p>
              </div>
              <div style="display: flex; flex-direction: column; gap: 8px;">
                <button onclick="copyEmail('${partner.email || ''}')" style="background: #25D366; color: white; border: none; padding: 8px 12px; border-radius: 6px; cursor: pointer; font-weight: bold; white-space: nowrap;">üìã Copy Email</button>
                <button onclick="emailPartner('${partner.email || ''}', '${partner.name || ''}')" style="background: #FFD700; color: #1e3c72; border: none; padding: 8px 12px; border-radius: 6px; cursor: pointer; font-weight: bold; white-space: nowrap;">üìß Email</button>
                <button onclick="deletePartnership('${partner.id}')" style="background: #dc2626; color: white; border: none; padding: 8px 12px; border-radius: 6px; cursor: pointer; font-weight: bold; white-space: nowrap;">üóëÔ∏è Delete</button>
              </div>
            </div>
          </div>
        `;
      }).join('');
    }

    // Copy email to clipboard
    function copyEmail(email) {
      if (!email) {
        showToast('‚ùå No email address available.', 'error');
        return;
      }
      navigator.clipboard.writeText(email).then(() => {
        showToast(`‚úÖ Copied: ${email}`, 'success');
      }).catch(() => {
        showToast('‚ùå Failed to copy email.', 'error');
      });
    }

    // Copy all emails to clipboard
    function copyAllEmails() {
      if (!isAdmin) {
        showToast('‚ùå Only admins can copy emails.', 'error');
        return;
      }

      const emails = partnershipRegistrations
        .map(p => p.email)
        .filter(email => email && email.trim())
        .join(', ');

      if (!emails) {
        showToast('‚ùå No email addresses found.', 'error');
        return;
      }

      navigator.clipboard.writeText(emails).then(() => {
        showToast(`‚úÖ Copied ${partnershipRegistrations.filter(p => p.email).length} email(s) to clipboard!`, 'success');
      }).catch(() => {
        showToast('‚ùå Failed to copy emails.', 'error');
      });
    }

    // Email a single partner
    function emailPartner(email, name) {
      if (!email) {
        showToast('‚ùå No email address available.', 'error');
        return;
      }

      const whatsappLink = localStorage.getItem('vimWhatsappLinkForEmail') || localStorage.getItem('vimWhatsappSocialUrl') || '';
      const subject = encodeURIComponent('Welcome to Vibrant Impact Ministries - WhatsApp Group Link');
      const body = encodeURIComponent(
        `Dear ${name || 'Partner'},\n\n` +
        `Thank you for registering as a partner with Vibrant Impact Ministries!\n\n` +
        `We're excited to have you join our community. Please use the link below to join our WhatsApp group:\n\n` +
        `${whatsappLink || '[WhatsApp link not configured yet]'}\n\n` +
        `God bless you!\n\n` +
        `Vibrant Impact Ministries`
      );

      window.location.href = `mailto:${email}?subject=${subject}&body=${body}`;
    }

    // Open email client with all partners
    function openEmailClient() {
      if (!isAdmin) {
        showToast('‚ùå Only admins can email partners.', 'error');
        return;
      }

      const emails = partnershipRegistrations
        .map(p => p.email)
        .filter(email => email && email.trim())
        .join(';');

      if (!emails) {
        showToast('‚ùå No email addresses found.', 'error');
        return;
      }

      const whatsappLink = localStorage.getItem('vimWhatsappLinkForEmail') || localStorage.getItem('vimWhatsappSocialUrl') || '';
      const subject = encodeURIComponent('Welcome to Vibrant Impact Ministries - WhatsApp Group Link');
      const body = encodeURIComponent(
        `Dear Partners,\n\n` +
        `Thank you for registering with Vibrant Impact Ministries!\n\n` +
        `We're excited to have you join our community. Please use the link below to join our WhatsApp group:\n\n` +
        `${whatsappLink || '[WhatsApp link not configured yet]'}\n\n` +
        `God bless you!\n\n` +
        `Vibrant Impact Ministries`
      );

      window.location.href = `mailto:${emails}?subject=${subject}&body=${body}`;
    }

    // Save WhatsApp link for emailing
    function saveWhatsAppLinkForEmail(link) {
      localStorage.setItem('vimWhatsappLinkForEmail', link);
      showToast('‚úÖ WhatsApp link saved for emailing!', 'success');
    }

    // Delete partnership registration
    async function deletePartnership(partnerId) {
      if (!isAdmin) {
        showToast('‚ùå Only admins can delete registrations.', 'error');
        return;
      }

      if (!confirm('Are you sure you want to delete this partnership registration?')) {
        return;
      }

      try {
        await db.collection('partners').doc(partnerId).delete();
        partnershipRegistrations = partnershipRegistrations.filter(p => p.id !== partnerId);
        renderPartnershipRegistrations();
        showToast('‚úÖ Registration deleted.', 'success');
      } catch (error) {
        console.error('Delete failed:', error);
        showToast('‚ùå Failed to delete: ' + error.message, 'error');
      }
    }

    // Set up real-time listener for new partnership registrations
    function setupPartnershipListener() {
      if (!isAdmin) return;

      // Remove existing listener if any
      if (partnershipListener) {
        partnershipListener();
        partnershipListener = null;
      }

      // Set up new listener
      partnershipListener = db.collection('partners')
        .orderBy('submittedAt', 'desc')
        .limit(1)
        .onSnapshot((snapshot) => {
          snapshot.docChanges().forEach((change) => {
            if (change.type === 'added') {
              const newPartner = { id: change.doc.id, ...change.doc.data() };
              
              // Show browser notification
              showNotification(
                'New Partnership Registration! üéâ',
                `${newPartner.name || 'Someone'} registered as ${newPartner.partnershipType || 'a partner'}`,
                'üîî'
              );

              // Show toast notification
              showToast(`üîî New partner: ${newPartner.name || 'Someone'} registered!`, 'success');

              // Reload the list if we're on the admin page
              if (document.getElementById('partnershipRegistrationsList')) {
                loadPartnershipRegistrations();
              }
            }
          });
        }, (error) => {
          console.error('Partnership listener error:', error);
        });
    }

    // Open giving links with validation
    function openGiveLink(type) {
      const url = type === 'paypal' ? givingSettings.paypalUrl : givingSettings.paystackUrl;
      if (url) {
        window.open(url, '_blank', 'noopener,noreferrer');
      } else {
        showToast('‚ö†Ô∏è No link configured yet. Admins can set one in Settings.', 'error');
      }
    }

    // Apply giving settings to UI and admin form
    function applyGivingSettings() {
      const bankNameEl = document.getElementById('bankNameDisplay');
      const accountNumberEl = document.getElementById('accountNumberDisplay');
      const accountNameEl = document.getElementById('accountNameDisplay');
      const paystackBtn = document.getElementById('paystackBtn');
      const paypalBtn = document.getElementById('paypalBtn');

      if (bankNameEl) bankNameEl.textContent = givingSettings.bankName || 'Not set';
      if (accountNumberEl) accountNumberEl.textContent = givingSettings.accountNumber || 'Not set';
      if (accountNameEl) accountNameEl.textContent = givingSettings.accountName || 'Not set';

      if (paystackBtn) {
        paystackBtn.disabled = !givingSettings.paystackUrl;
        paystackBtn.title = givingSettings.paystackUrl ? 'Open Paystack giving link' : 'Add a Paystack link in Admin settings';
      }
      if (paypalBtn) {
        paypalBtn.disabled = !givingSettings.paypalUrl;
        paypalBtn.title = givingSettings.paypalUrl ? 'Open PayPal giving link' : 'Add a PayPal link in Admin settings';
      }

      // Prefill admin form when available
      if (isAdmin) {
        const paystackInput = document.getElementById('adminPaystackUrl');
        const paypalInput = document.getElementById('adminPaypalUrl');
        const bankNameInput = document.getElementById('adminBankName');
        const accountNumberInput = document.getElementById('adminAccountNumber');
        const accountNameInput = document.getElementById('adminAccountName');

        if (paystackInput) paystackInput.value = givingSettings.paystackUrl || '';
        if (paypalInput) paypalInput.value = givingSettings.paypalUrl || '';
        if (bankNameInput) bankNameInput.value = givingSettings.bankName || '';
        if (accountNumberInput) accountNumberInput.value = givingSettings.accountNumber || '';
        if (accountNameInput) accountNameInput.value = givingSettings.accountName || '';
      }
    }

    // Load giving settings from Firestore (with defaults)
    async function loadGivingSettings() {
      try {
        const doc = await db.collection('settings').doc('giving').get();
        const data = doc.exists ? doc.data() : {};
        givingSettings = { ...DEFAULT_GIVING, ...data };
      } catch (error) {
        console.error('Error loading giving settings:', error);
        givingSettings = { ...DEFAULT_GIVING };
      } finally {
        applyGivingSettings();
      }
    }

    // Save giving settings (admin)
    async function saveGivingSettings() {
      if (!isAdmin) {
        showToast('‚ùå Only admins can update payment details.', 'error');
        return;
      }

      const paystackUrl = document.getElementById('adminPaystackUrl').value.trim();
      const paypalUrl = document.getElementById('adminPaypalUrl').value.trim();
      const bankName = document.getElementById('adminBankName').value.trim() || DEFAULT_GIVING.bankName;
      const accountNumber = document.getElementById('adminAccountNumber').value.trim() || DEFAULT_GIVING.accountNumber;
      const accountName = document.getElementById('adminAccountName').value.trim() || DEFAULT_GIVING.accountName;

      const dataToSave = {
        paystackUrl: paystackUrl,
        paypalUrl: paypalUrl,
        bankName: bankName,
        accountNumber: accountNumber,
        accountName: accountName
      };

      try {
        await db.collection('settings').doc('giving').set({
          ...dataToSave,
          updatedAt: firebase.firestore.FieldValue.serverTimestamp(),
          updatedBy: currentUser?.email || 'admin'
        }, { merge: true });

        givingSettings = { ...DEFAULT_GIVING, ...dataToSave };
        applyGivingSettings();
        showToast('‚úÖ Payment details saved!', 'success');
      } catch (error) {
        showToast('‚ùå Failed to save payment details: ' + error.message, 'error');
      }
    }

    function formatAddressLines(addressText) {
      return (addressText || '').split('\n').filter(Boolean).join('<br>');
    }

    // Apply contact info to all visible spots
    function applyContactInfo() {
      const email = contactSettings.email || DEFAULT_CONTACT.email;
      const phone = contactSettings.phone || DEFAULT_CONTACT.phone;
      const addressRaw = (contactSettings.address || DEFAULT_CONTACT.address).replace(/<br\s*\/?>/gi, '\n');
      const address = addressRaw || DEFAULT_CONTACT.address;

      const addressDisplay = document.getElementById('contactAddressDisplay');
      const contactEmailDisplay = document.getElementById('contactEmailDisplay');
      const contactPhoneDisplay = document.getElementById('contactPhoneDisplay');
      const prayerEmailDisplay = document.getElementById('prayerEmailDisplay');
      const prayerPhoneDisplay = document.getElementById('prayerPhoneDisplay');
      const footerContactLine = document.getElementById('footerContactLine');

      if (addressDisplay) addressDisplay.innerHTML = formatAddressLines(address);
      if (contactEmailDisplay) contactEmailDisplay.textContent = email;
      if (contactPhoneDisplay) contactPhoneDisplay.textContent = phone;
      if (prayerEmailDisplay) prayerEmailDisplay.textContent = email;
      if (prayerPhoneDisplay) prayerPhoneDisplay.textContent = phone;
      if (footerContactLine) footerContactLine.textContent = `Email: ${email} | Phone: ${phone}`;

      if (isAdmin) {
        const emailInput = document.getElementById('adminContactEmail');
        const phoneInput = document.getElementById('adminContactPhone');
        const addressInput = document.getElementById('adminContactAddress');

        if (emailInput) emailInput.value = email;
        if (phoneInput) phoneInput.value = phone;
        if (addressInput) addressInput.value = address;
      }
    }

    // Load contact info from Firestore (with defaults)
    async function loadContactInfo() {
      try {
        const doc = await db.collection('settings').doc('contact').get();
        const data = doc.exists ? doc.data() : {};
        contactSettings = { ...DEFAULT_CONTACT, ...data };
      } catch (error) {
        console.error('Error loading contact info:', error);
        contactSettings = { ...DEFAULT_CONTACT };
      } finally {
        applyContactInfo();
      }
    }

    // Save contact info (admin)
    async function saveContactInfo() {
      if (!isAdmin) {
        showToast('‚ùå Only admins can update contact info.', 'error');
        return;
      }

      const email = document.getElementById('adminContactEmail').value.trim() || DEFAULT_CONTACT.email;
      const phone = document.getElementById('adminContactPhone').value.trim() || DEFAULT_CONTACT.phone;
      const address = document.getElementById('adminContactAddress').value.trim() || DEFAULT_CONTACT.address;

      const dataToSave = { email, phone, address };

      try {
        await db.collection('settings').doc('contact').set({
          ...dataToSave,
          updatedAt: firebase.firestore.FieldValue.serverTimestamp(),
          updatedBy: currentUser?.email || 'admin'
        }, { merge: true });

        contactSettings = { ...DEFAULT_CONTACT, ...dataToSave };
        applyContactInfo();
        showToast('‚úÖ Contact info saved!', 'success');
      } catch (error) {
        showToast('‚ùå Failed to save contact info: ' + error.message, 'error');
      }
    }

    // Update about content
    function updateAboutContent() {
      if (!isAdmin) {
        showToast('‚ùå Only admins can update about content.', 'error');
        return;
      }

      const history = document.getElementById('aboutHistory').value.trim();
      const vision = document.getElementById('aboutVision').value.trim();
      const mission = document.getElementById('aboutMission').value.trim();
      const beliefs = document.getElementById('aboutBeliefs').value.trim();
      const pastorName = document.getElementById('pastorName').value.trim();
      const pastorPhotoUrl = document.getElementById('pastorPhotoUrl').value.trim();
      const pastorBio = document.getElementById('pastorBio').value.trim();
      const pastorWifeName = document.getElementById('pastorWifeName').value.trim();
      const pastorWifePhotoUrl = document.getElementById('pastorWifePhotoUrl').value.trim();
      const pastorWifeBio = document.getElementById('pastorWifeBio').value.trim();

      // Save to localStorage
      if (history) localStorage.setItem('vimAboutHistory', history);
      if (vision) localStorage.setItem('vimAboutVision', vision);
      if (mission) localStorage.setItem('vimAboutMission', mission);
      if (beliefs) localStorage.setItem('vimAboutBeliefs', beliefs);
      if (pastorName) localStorage.setItem('vimPastorName', pastorName);
      if (pastorPhotoUrl) localStorage.setItem('vimPastorPhotoUrl', pastorPhotoUrl);
      if (pastorBio) localStorage.setItem('vimPastorBio', pastorBio);
      if (pastorWifeName) localStorage.setItem('vimPastorWifeName', pastorWifeName);
      if (pastorWifePhotoUrl) localStorage.setItem('vimPastorWifePhotoUrl', pastorWifePhotoUrl);
      if (pastorWifeBio) localStorage.setItem('vimPastorWifeBio', pastorWifeBio);

      // Update display
      loadAboutContent();

      showToast('‚úÖ About content updated successfully!', 'success');
    }

    // Load about content
    function loadAboutContent() {
      const defaultHistory = "Vibrant Impact Ministries (VIM) was established in 2020 with a divine mandate to raise vibrant believers who would make lasting kingdom impact. Located in the heart of Akure, Ondo State, Nigeria, we are a prophetic and teaching church committed to equipping believers for effective kingdom service.";
      const defaultVision = "To raise a generation of vibrant believers who are spiritually alive, prophetically empowered, and making tangible kingdom impact in their communities and beyond.";
      const defaultMission = "We are committed to:\n‚Ä¢ Teaching the uncompromised Word of God\n‚Ä¢ Activating believers in the prophetic\n‚Ä¢ Providing deliverance and counseling ministry\n‚Ä¢ Equipping the saints for kingdom service\n‚Ä¢ Raising prayer warriors and intercessors";
      const defaultBeliefs = "We believe in the infallibility of Scripture, the deity of Jesus Christ, salvation through faith in Christ alone, the baptism of the Holy Spirit, divine healing, and the imminent return of our Lord Jesus Christ.";
      const defaultPastorName = "Prophet Valentine Ifedayo";
      const defaultPastorPhotoUrl = "https://lh3.googleusercontent.com/d/19iPQ2uK4vDTMBCeXxDt03GvMnn2h-C_a";
      const defaultPastorBio = "Prophet Valentine Ifedayo is the Lead Pastor and Founder of Vibrant Impact Ministries. Called by God as a prophet and teacher, he carries a burden for raising believers who are spiritually alive and impactful. His teaching ministry emphasizes practical kingdom living, prophetic activation, and spiritual warfare.\n\nProphet Valentine is passionate about seeing believers walk in their God-given purpose and destiny. His ministry is characterized by the demonstration of the Spirit's power, accurate prophetic ministry, and life-transforming teaching of God's Word.";

      const history = localStorage.getItem('vimAboutHistory') || defaultHistory;
      const vision = localStorage.getItem('vimAboutVision') || defaultVision;
      const mission = localStorage.getItem('vimAboutMission') || defaultMission;
      const beliefs = localStorage.getItem('vimAboutBeliefs') || defaultBeliefs;
      const pastorName = localStorage.getItem('vimPastorName') || defaultPastorName;
      const pastorPhotoUrl = localStorage.getItem('vimPastorPhotoUrl') || defaultPastorPhotoUrl;
      const pastorBio = localStorage.getItem('vimPastorBio') || defaultPastorBio;

      // Update About page content
      const aboutHistoryText = document.getElementById('aboutHistoryText');
      const aboutVisionText = document.getElementById('aboutVisionText');
      const aboutBeliefsText = document.getElementById('aboutBeliefsText');
      const aboutMissionContent = document.getElementById('aboutMissionContent');
      const pastorNameDisplay = document.getElementById('pastorNameDisplay');
      const pastorPhoto = document.getElementById('pastorPhoto');
      const pastorBioText = document.getElementById('pastorBioText');
      const pastorBioText2 = document.getElementById('pastorBioText2');

      if (aboutHistoryText) aboutHistoryText.textContent = history;
      if (aboutVisionText) aboutVisionText.textContent = vision;
      if (aboutBeliefsText) aboutBeliefsText.textContent = beliefs;
      
      if (aboutMissionContent) {
        const missionList = mission.split('\n').filter(line => line.trim());
        aboutMissionContent.innerHTML = `
          <p>${missionList[0]}</p>
          <ul>
            ${missionList.slice(1).map(item => `<li>${item.replace('‚Ä¢', '').trim()}</li>`).join('')}
          </ul>
        `;
      }

      if (pastorNameDisplay) pastorNameDisplay.textContent = pastorName;
      if (pastorPhoto) pastorPhoto.src = pastorPhotoUrl;
      
      const paragraphs = pastorBio.split('\n\n');
      if (pastorBioText) pastorBioText.textContent = paragraphs[0] || '';
      if (pastorBioText2) pastorBioText2.textContent = paragraphs[1] || '';

      // Update pastor's wife section
      const pastorWifeName = localStorage.getItem('vimPastorWifeName') || '';
      const pastorWifePhotoUrl = localStorage.getItem('vimPastorWifePhotoUrl') || '';
      const pastorWifeBioText = localStorage.getItem('vimPastorWifeBio') || '';

      const pastorWifeSection = document.getElementById('pastorWifeSection');
      const pastorWifeNameDisplay = document.getElementById('pastorWifeNameDisplay');
      const pastorWifeImage = document.getElementById('pastorWifeImage');
      const pastorWifeBioDisplay = document.getElementById('pastorWifeBioText');

      // Show section if any content is provided (name, photo, or bio)
      if (pastorWifeName || pastorWifePhotoUrl || pastorWifeBioText) {
        if (pastorWifeSection) pastorWifeSection.style.display = 'block';
        if (pastorWifeNameDisplay) pastorWifeNameDisplay.textContent = pastorWifeName || "Pastor's Wife";
        if (pastorWifeImage) {
          if (pastorWifePhotoUrl) {
            pastorWifeImage.src = pastorWifePhotoUrl;
            pastorWifeImage.style.display = 'block';
          } else {
            pastorWifeImage.style.display = 'none';
          }
        }
        if (pastorWifeBioDisplay) pastorWifeBioDisplay.textContent = pastorWifeBioText;
      } else {
        if (pastorWifeSection) pastorWifeSection.style.display = 'none';
      }

      // Load into admin form fields if admin
      if (isAdmin) {
        const historyField = document.getElementById('aboutHistory');
        const visionField = document.getElementById('aboutVision');
        const missionField = document.getElementById('aboutMission');
        const beliefsField = document.getElementById('aboutBeliefs');
        const pastorNameField = document.getElementById('pastorName');
        const pastorPhotoField = document.getElementById('pastorPhotoUrl');
        const pastorBioField = document.getElementById('pastorBio');
        const pastorWifeNameField = document.getElementById('pastorWifeName');
        const pastorWifePhotoField = document.getElementById('pastorWifePhotoUrl');
        const pastorWifeBioField = document.getElementById('pastorWifeBio');

        if (historyField) historyField.value = history;
        if (visionField) visionField.value = vision;
        if (missionField) missionField.value = mission;
        if (beliefsField) beliefsField.value = beliefs;
        if (pastorNameField) pastorNameField.value = pastorName;
        if (pastorPhotoField) pastorPhotoField.value = pastorPhotoUrl;
        if (pastorBioField) pastorBioField.value = pastorBio;
        if (pastorWifeNameField) pastorWifeNameField.value = pastorWifeName;
        if (pastorWifePhotoField) pastorWifePhotoField.value = pastorWifePhotoUrl;
        if (pastorWifeBioField) pastorWifeBioField.value = pastorWifeBioText;
      }
    }

    // Load saved social links for admin
    function loadSavedSocialLinks() {
      const facebookUrl = localStorage.getItem('vimFacebookSocialUrl') || 'https://facebook.com/VibrantImpactMinistries';
      const youtubeUrl = localStorage.getItem('vimYoutubeSocialUrl') || 'https://youtube.com/@ProphetValentineIfedayoChannel';
      const tiktokUrl = localStorage.getItem('vimTiktokSocialUrl') || 'https://tiktok.com/@prophet_valentineifedayo';
      const twitchUrl = localStorage.getItem('vimTwitchSocialUrl') || 'https://twitch.tv/vibrantimpactministries';
      const whatsappUrl = localStorage.getItem('vimWhatsappSocialUrl') || 'https://chat.whatsapp.com/your-group-link';

      const facebookInput = document.getElementById('facebookPageUrl');
      const youtubeInput = document.getElementById('youtubeChannelUrl');
      const tiktokInput = document.getElementById('tiktokProfileUrl');
      const twitchInput = document.getElementById('twitchChannelUrl');
      const whatsappInput = document.getElementById('whatsappGroupUrl');

      if (facebookInput) facebookInput.value = facebookUrl;
      if (youtubeInput) youtubeInput.value = youtubeUrl;
      if (tiktokInput) tiktokInput.value = tiktokUrl;
      if (twitchInput) twitchInput.value = twitchUrl;
      if (whatsappInput) whatsappInput.value = whatsappUrl;
    }

    // Open live stream
    function openLiveStream() {
      const youtubeUrl = localStorage.getItem('vimYoutubeLiveUrl');
      const facebookUrl = localStorage.getItem('vimFacebookLiveUrl');
      const tiktokUrl = localStorage.getItem('vimTiktokLiveUrl');
      
      if (youtubeUrl) {
        window.open(youtubeUrl, '_blank', 'noopener,noreferrer');
      } else if (facebookUrl) {
        window.open(facebookUrl, '_blank', 'noopener,noreferrer');
      } else if (tiktokUrl) {
        window.open(tiktokUrl, '_blank', 'noopener,noreferrer');
      } else {
        showToast('‚ö†Ô∏è No live stream URL configured yet.', 'error');
      }
    }

    // Load saved live stream URLs when admin settings page opens
    function loadSavedLiveStreamUrls() {
      const youtubeUrl = localStorage.getItem('vimYoutubeLiveUrl') || '';
      const facebookUrl = localStorage.getItem('vimFacebookLiveUrl') || '';
      const tiktokUrl = localStorage.getItem('vimTiktokLiveUrl') || '';

      const youtubeInput = document.getElementById('youtubeLiveUrl');
      const facebookInput = document.getElementById('facebookLiveUrl');
      const tiktokInput = document.getElementById('tiktokLiveUrl');

      if (youtubeInput) youtubeInput.value = youtubeUrl;
      if (facebookInput) facebookInput.value = facebookUrl;
      if (tiktokInput) tiktokInput.value = tiktokUrl;
    }

    // Set live streaming status (admin only)
    async function setLiveStatus(isLive) {
      if (!currentUser) {
        showToast('‚ùå Please login as admin first.', 'error');
        return;
      }

      if (!ADMIN_EMAILS.includes(currentUser.email)) {
        showToast('‚ùå Only admins can control live status.', 'error');
        return;
      }

      try {
        // Save to localStorage
        localStorage.setItem('vimIsLive', isLive ? 'true' : 'false');

        // Try to save to Firestore
        try {
          await db.collection('settings').doc('liveStatus').set({
            isLive: isLive,
            updatedAt: firebase.firestore.FieldValue.serverTimestamp(),
            updatedBy: currentUser.email
          });
        } catch (firestoreError) {
          console.log('Firestore save skipped:', firestoreError);
        }

        // Update UI immediately
        updateLiveStatusDisplay();

        const statusMessage = isLive 
          ? 'üî¥ LIVE! The banner is now visible to all visitors on the home page and media page.' 
          : '‚ö´ Stream ended. The live banner has been hidden from all visitors.';
        
        showToast(`‚úÖ ${statusMessage}`, 'success');
      } catch (error) {
        console.error('Live status update error:', error);
        showToast('‚ùå Failed to update live status. Please try again.', 'error');
      }
    }

    // Update live status display across the site
    function updateLiveStatusDisplay() {
      const isLive = localStorage.getItem('vimIsLive') === 'true';
      
      // Update home page live alert
      const homeLiveAlert = document.getElementById('homeLiveAlert');
      if (homeLiveAlert) {
        homeLiveAlert.style.display = isLive ? 'block' : 'none';
      }

      // Update media page live alert
      const mediaLiveAlert = document.getElementById('mediaLiveAlert');
      if (mediaLiveAlert) {
        mediaLiveAlert.style.display = isLive ? 'block' : 'none';
      }

      // Update admin settings status text
      const liveStatusText = document.getElementById('liveStatusText');
      if (liveStatusText) {
        if (isLive) {
          liveStatusText.innerHTML = 'üî¥ LIVE NOW';
          liveStatusText.style.color = '#dc2626';
        } else {
          liveStatusText.innerHTML = '‚ö´ OFFLINE';
          liveStatusText.style.color = '#6b7280';
        }
      }
    }

    // Update departments user section
    function updateDepartmentsUserSection() {
      const deptUserSection = document.getElementById('departmentsUserSection');
      
      if (currentUser) {
        deptUserSection.innerHTML = `
          <div class="user-info">
            <p><strong>Logged in as:</strong> ${currentUser.email}</p>
            ${isAdmin ? '<p style="color: #FFD700; font-weight: bold;">‚≠ê ADMIN ACCESS - You can add, edit, and delete departments</p>' : '<p>‚úÖ Viewing departments</p>'}
          </div>
        `;
      } else {
        deptUserSection.innerHTML = `
          <div class="user-info">
            <p>Please <a onclick="navigateTo('auth')" style="color: #1e3c72; cursor: pointer; text-decoration: underline; font-weight: bold;">login</a> as admin to manage departments</p>
          </div>
        `;
      }
      
      // Show/hide admin department section
      const adminDeptSection = document.getElementById('adminDepartmentSection');
      if (isAdmin) {
        adminDeptSection.classList.add('show');
      } else {
        adminDeptSection.classList.remove('show');
      }
    }

    // Save department (add or update)
    async function saveDepartment(event) {
      event.preventDefault();
      
      if (!isAdmin) {
        showToast('‚ùå Only admins can manage departments.', 'error');
        return;
      }
      
      const deptId = document.getElementById('deptId').value;
      const name = document.getElementById('deptName').value;
      const description = document.getElementById('deptDescription').value;
      const imageUrl = document.getElementById('deptImageUrl').value;
      
      const loadingSpinner = document.getElementById('departmentsLoading');
      loadingSpinner.classList.add('show');
      
      try {
        if (deptId) {
          // Update existing department
          await db.collection('departments').doc(deptId).update({
            name: name,
            description: description,
            imageUrl: imageUrl,
            updatedAt: firebase.firestore.FieldValue.serverTimestamp(),
            updatedBy: currentUser.email
          });
          showToast('‚úÖ Department updated successfully!', 'success');
        } else {
          // Add new department
          await db.collection('departments').add({
            name: name,
            description: description,
            imageUrl: imageUrl,
            createdBy: currentUser.email,
            createdAt: firebase.firestore.FieldValue.serverTimestamp()
          });
          showToast('‚úÖ Department added successfully!', 'success');
        }
        
        cancelEditDepartment();
        loadDepartments();
      } catch (error) {
        showToast('‚ùå Failed to save department: ' + error.message, 'error');
      } finally {
        loadingSpinner.classList.remove('show');
      }
    }

    // Edit department (admin only)
    function editDepartment(deptId) {
      if (!isAdmin) {
        showToast('‚ùå Only admins can edit departments.', 'error');
        return;
      }
      
      const dept = departments.find(d => d.id === deptId);
      if (!dept) {
        showToast('‚ùå Department not found.', 'error');
        return;
      }
      
      // Pre-fill form with department data
      document.getElementById('deptId').value = dept.id;
      document.getElementById('deptName').value = dept.name || '';
      document.getElementById('deptDescription').value = dept.description || '';
      document.getElementById('deptImageUrl').value = dept.imageUrl || '';
      
      // Update form title and button
      document.getElementById('deptFormTitle').textContent = 'Edit Department (Admin Only)';
      document.getElementById('deptSubmitBtn').textContent = 'Update Department';
      document.getElementById('deptCancelBtn').style.display = 'block';
      
      // Scroll to form
      document.getElementById('adminDepartmentSection').scrollIntoView({ behavior: 'smooth', block: 'start' });
    }

    // Cancel edit and reset form
    function cancelEditDepartment() {
      document.getElementById('deptId').value = '';
      document.getElementById('departmentForm').reset();
      document.getElementById('deptFormTitle').textContent = 'Add Department (Admin Only)';
      document.getElementById('deptSubmitBtn').textContent = 'Add Department';
      document.getElementById('deptCancelBtn').style.display = 'none';
    }

    // Load departments
    async function loadDepartments() {
      const departmentsGrid = document.getElementById('departmentsGrid');
      const loadingSpinner = document.getElementById('departmentsLoading');
      
      loadingSpinner.classList.add('show');
      
      try {
        const snapshot = await db.collection('departments').orderBy('createdAt', 'desc').get();
        departments = [];
        
        snapshot.forEach(doc => {
          departments.push({ id: doc.id, ...doc.data() });
        });
        
        renderDepartments();
        renderDepartmentsOnAboutPage();
      } catch (error) {
        console.error('Error loading departments:', error);
        departmentsGrid.innerHTML = '<p style="text-align: center; color: #666;">No departments added yet. Admins can add departments.</p>';
      } finally {
        loadingSpinner.classList.remove('show');
      }
    }

    // Render departments on departments page
    function renderDepartments() {
      const departmentsGrid = document.getElementById('departmentsGrid');
      
      if (departments.length === 0) {
        departmentsGrid.innerHTML = '<p style="text-align: center; color: #666;">No departments added yet. Admins can add departments.</p>';
        return;
      }
      
      departmentsGrid.innerHTML = departments.map(dept => `
        <div class="department-card">
          <img src="${dept.imageUrl}" alt="${dept.name}" onerror="this.src=''; this.alt='Image failed to load'; this.style.display='none';">
          <div class="department-info">
            <h4>${dept.name}</h4>
            <p>${dept.description}</p>
            ${isAdmin ? `
              <div class="department-actions" style="display: flex; gap: 10px; margin-top: 10px;">
                <button class="edit-btn" style="background: #1e3c72; color: white; flex: 1; padding: 10px; border: none; border-radius: 5px; cursor: pointer; font-weight: bold;" onclick="editDepartment('${dept.id}')">‚úèÔ∏è Edit</button>
                <button class="delete-btn" style="background: #dc2626; color: white; flex: 1; padding: 10px; border: none; border-radius: 5px; cursor: pointer; font-weight: bold;" onclick="deleteDepartment('${dept.id}')">üóëÔ∏è Delete</button>
              </div>
            ` : ''}
          </div>
        </div>
      `).join('');
    }

    // Render departments on About page
    function renderDepartmentsOnAboutPage() {
      const departmentsList = document.getElementById('departmentsList');
      
      if (!departmentsList) return;
      
      if (departments.length === 0) {
        departmentsList.innerHTML = '<p style="text-align: center; color: #666; padding: 20px;">No departments added yet.</p>';
        return;
      }
      
      departmentsList.innerHTML = `
        <div class="events-grid">
          ${departments.map(dept => `
            <div class="event-card department-card" data-dept-id="${dept.id}">
              <img src="${dept.imageUrl}" alt="${dept.name}" style="width: 100%; height: 150px; object-fit: cover; border-radius: 10px; margin-bottom: 15px;" onerror="this.style.display='none';">
              <h4 style="color: #1e3c72; margin: 0 0 10px 0;">${dept.name}</h4>
              <p style="color: #555;">${dept.description}</p>
              ${isAdmin ? `
                <div style="display: flex; gap: 10px; margin-top: 10px;">
                  <button onclick="editDepartment('${dept.id}')" style="background: #1e3c72; color: white; padding: 8px 16px; border: none; border-radius: 5px; cursor: pointer; flex: 1; font-weight: bold;">‚úèÔ∏è Edit</button>
                  <button onclick="deleteDepartment('${dept.id}')" style="background: #dc2626; color: white; padding: 8px 16px; border: none; border-radius: 5px; cursor: pointer; flex: 1; font-weight: bold;">üóëÔ∏è Delete</button>
                </div>
              ` : ''}
            </div>
          `).join('')}
        </div>
      `;
    }

    // Delete department (admin only)
    async function deleteDepartment(deptId) {
      if (!isAdmin) {
        showToast('‚ùå Only admins can delete departments.', 'error');
        return;
      }
      
      // Inline confirmation
      const deptCard = document.querySelector(`[onclick="deleteDepartment('${deptId}')"]`).closest('.department-card');
      const originalHTML = deptCard.innerHTML;
      
      deptCard.innerHTML = `
        <div style="padding: 40px; text-align: center;">
          <p style="margin: 20px 0; font-weight: bold;">Delete this department?</p>
          <button onclick="confirmDeleteDepartment('${deptId}')" style="background: #dc2626; color: white; padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; margin: 5px;">Yes, Delete</button>
          <button onclick="loadDepartments()" style="background: #6b7280; color: white; padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; margin: 5px;">Cancel</button>
        </div>
      `;
    }

    async function confirmDeleteDepartment(deptId) {
      try {
        await db.collection('departments').doc(deptId).delete();
        showToast('‚úÖ Department deleted successfully!', 'success');
        loadDepartments();
      } catch (error) {
        showToast('‚ùå Delete failed: ' + error.message, 'error');
      }
    }

    // Fire Night Countdown
    function getNextFireNight() {
      // Use custom date if set
      if (customFireNightDate) {
        return customFireNightDate;
      }
      
      const now = new Date();
      const currentMonth = now.getMonth();
      const currentYear = now.getFullYear();
      
      // Get last Friday of current month
      let lastFriday = new Date(currentYear, currentMonth + 1, 0);
      while (lastFriday.getDay() !== 5) {
        lastFriday.setDate(lastFriday.getDate() - 1);
      }
      
      // Set time to 10:00 PM
      lastFriday.setHours(22, 0, 0, 0);
      
      // If Fire Night has passed this month, get next month's
      if (now > lastFriday) {
        lastFriday = new Date(currentYear, currentMonth + 2, 0);
        while (lastFriday.getDay() !== 5) {
          lastFriday.setDate(lastFriday.getDate() - 1);
        }
        lastFriday.setHours(22, 0, 0, 0);
      }
      
      return lastFriday;
    }

    function updateCountdown() {
      const nextFireNight = getNextFireNight();
      const now = new Date();
      const difference = nextFireNight - now;
      
      if (difference > 0) {
        const days = Math.floor(difference / (1000 * 60 * 60 * 24));
        const hours = Math.floor((difference % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
        const minutes = Math.floor((difference % (1000 * 60 * 60)) / (1000 * 60));
        const seconds = Math.floor((difference % (1000 * 60)) / 1000);
        
        document.getElementById('days').textContent = String(days).padStart(2, '0');
        document.getElementById('hours').textContent = String(hours).padStart(2, '0');
        document.getElementById('minutes').textContent = String(minutes).padStart(2, '0');
        document.getElementById('seconds').textContent = String(seconds).padStart(2, '0');
      }
    }

    // Add upcoming event (admin only)
    async function addUpcomingEvent(event) {
      event.preventDefault();
      
      if (!isAdmin) {
        showToast('‚ùå Only admins can add events.', 'error');
        return;
      }
      
      const imageUrl = document.getElementById('eventImageUrl').value.trim();
      const title = document.getElementById('eventTitle').value;
      const schedule = document.getElementById('eventSchedule').value;
      const time = document.getElementById('eventTime').value;
      const description = document.getElementById('eventDescription').value;
      
      try {
        await db.collection('upcomingEvents').add({
          imageUrl: imageUrl,
          title: title,
          schedule: schedule,
          time: time,
          description: description,
          createdBy: currentUser.email,
          createdAt: firebase.firestore.FieldValue.serverTimestamp()
        });
        
        showToast('‚úÖ Event added successfully!', 'success');
        document.getElementById('addEventForm').reset();
        loadUpcomingEvents();
      } catch (error) {
        showToast('‚ùå Failed to add event: ' + error.message, 'error');
      }
    }

    // Load upcoming events
    async function loadUpcomingEvents() {
      try {
        const snapshot = await db.collection('upcomingEvents').orderBy('createdAt', 'asc').get();
        upcomingEvents = [];
        
        snapshot.forEach(doc => {
          upcomingEvents.push({ id: doc.id, ...doc.data() });
        });
        
        renderUpcomingEvents();
        renderCurrentEventsList();
      } catch (error) {
        console.error('Error loading events:', error);
        const eventsGrid = document.getElementById('upcomingEventsGrid');
        if (eventsGrid) {
          eventsGrid.innerHTML = '<p style="text-align: center; color: #666; padding: 40px;">No upcoming events yet. Admins can add events.</p>';
        }
      }
    }

    // Render upcoming events on home page
    function renderUpcomingEvents() {
      const eventsGrid = document.getElementById('upcomingEventsGrid');
      
      if (!eventsGrid) return;
      
      // Default Sunday and Tuesday services (always shown)
      const defaultEvents = [
        {
          imageUrl: '',
          title: 'Sunday Glory Service',
          schedule: 'Every Sunday',
          time: '9:00 AM',
          description: 'Our main worship service featuring powerful praise and worship, life-transforming messages, and prophetic ministry.'
        },
        {
          imageUrl: '',
          title: 'Tuesday Deliverance & Counselling',
          schedule: 'Every Tuesday',
          time: '9:00 AM',
          description: 'A special service dedicated to deliverance ministry and pastoral counseling. Bring your burdens and receive freedom and guidance.'
        }
      ];
      
      // Combine default events with custom events
      const allEvents = [...defaultEvents, ...upcomingEvents];
      
      eventsGrid.innerHTML = allEvents.map(event => `
        <div class="event-card">
          ${event.imageUrl ? `<img src="${event.imageUrl}" alt="${event.title}" style="width: 100%; height: 150px; object-fit: cover; border-radius: 10px; margin-bottom: 15px;" onerror="this.style.display='none';">` : ''}
          <h4>${event.title}</h4>
          <p><strong>${event.schedule}</strong></p>
          <p>‚è∞ ${event.time}</p>
          <p>${event.description}</p>
        </div>
      `).join('');
    }

    // Render current events list in admin
    function renderCurrentEventsList() {
      const currentEventsList = document.getElementById('currentEventsList');
      
      if (!currentEventsList) return;
      
      if (upcomingEvents.length === 0) {
        currentEventsList.innerHTML = '<p style="text-align: center; color: #666;">No events added yet.</p>';
        return;
      }
      
      currentEventsList.innerHTML = upcomingEvents.map(event => `
        <div style="background: white; padding: 15px; border-radius: 8px; border: 2px solid #ddd;">
          ${event.imageUrl ? `<img src="${event.imageUrl}" alt="${event.title}" style="width: 100%; height: 100px; object-fit: cover; border-radius: 8px; margin-bottom: 10px;" onerror="this.style.display='none';">` : ''}
          <h5 style="margin: 0 0 10px 0; color: #1e3c72;">${event.title}</h5>
          <p style="margin: 5px 0; font-size: 14px;"><strong>Schedule:</strong> ${event.schedule}</p>
          <p style="margin: 5px 0; font-size: 14px;"><strong>Time:</strong> ${event.time}</p>
          <p style="margin: 5px 0; font-size: 14px;">${event.description}</p>
          <button onclick="deleteUpcomingEvent('${event.id}')" style="background: #dc2626; color: white; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer; margin-top: 10px; font-weight: bold;">üóëÔ∏è Delete</button>
        </div>
      `).join('');
    }

    // Delete upcoming event (admin only)
    async function deleteUpcomingEvent(eventId) {
      if (!isAdmin) {
        showToast('‚ùå Only admins can delete events.', 'error');
        return;
      }
      
      try {
        await db.collection('upcomingEvents').doc(eventId).delete();
        showToast('‚úÖ Event deleted successfully!', 'success');
        loadUpcomingEvents();
      } catch (error) {
        showToast('‚ùå Delete failed: ' + error.message, 'error');
      }
    }

    // Hero background rotation
    const heroBackgrounds = [
      'https://lh3.googleusercontent.com/d/1exCpQcpobaYeFM3LJx8EwrdCPYbmy_wy',
      'https://lh3.googleusercontent.com/d/1wYyfuB0DgYFH6GLFJX4EHcPIQMD_NKoX'
    ];
    let currentBgIndex = 0;

    function rotateHeroBackground() {
      const heroSection = document.getElementById('heroSection');
      if (heroSection) {
        currentBgIndex = (currentBgIndex + 1) % heroBackgrounds.length;
        heroSection.style.backgroundImage = `url('${heroBackgrounds[currentBgIndex]}')`;
        heroSection.style.backgroundSize = 'cover';
        heroSection.style.backgroundPosition = 'center';
      }
    }

    // Handle video loading errors with detailed feedback
    function handleVideoError(videoElement, url, title) {
      console.log('Video failed to load:', url);
      const errorDiv = videoElement.nextElementSibling;
      if (errorDiv) {
        // Provide more specific error message
        let errorMessage = 'üìπ Video Preview Unavailable';
        let suggestion = '';
        
        if (url.includes('firebasestorage')) {
          suggestion = '<p style="font-size: 14px; margin: 10px 0;">The video file may have been deleted or moved. Try re-uploading the video.</p>';
        } else if (url.includes('drive.google.com')) {
          suggestion = '<p style="font-size: 14px; margin: 10px 0;">Google Drive links require public sharing permissions. Make sure the video is set to "Anyone with the link can view".</p>';
        } else {
          suggestion = '<p style="font-size: 14px; margin: 10px 0;">The video URL may be incorrect or the file may no longer exist.</p>';
        }
        
        errorDiv.innerHTML = `
          <p style="margin: 10px 0;">${errorMessage}</p>
          ${suggestion}
          <a href="${url}" download target="_blank" rel="noopener noreferrer" style="color: #FFD700; text-decoration: underline; font-weight: bold;">‚¨áÔ∏è Try Download Link</a>
        `;
        errorDiv.style.display = 'block';
      }
      videoElement.style.display = 'none';
    }

    // Save hero images
    async function saveHeroImages() {
      if (!isAdmin) { showToast('‚ùå Admin access required', 'error'); return; }
      const img1 = document.getElementById('heroImage1').value.trim();
      const img2 = document.getElementById('heroImage2').value.trim();
      const img3 = document.getElementById('heroImage3').value.trim();
      try {
        await db.collection('settings').doc('heroImages').set({
          images: [img1, img2, img3].filter(url => url),
          updatedAt: firebase.firestore.FieldValue.serverTimestamp()
        });
        showToast('‚úÖ Hero images saved!', 'success');
        loadHomepageSettings();
      } catch (error) { showToast('‚ùå Failed to save: ' + error.message, 'error'); }
    }

    // Save Glory Service video
    async function saveGloryServiceVideo() {
      if (!isAdmin) { showToast('‚ùå Admin access required', 'error'); return; }
      const videoUrl = document.getElementById('gloryServiceVideo').value.trim();
      try {
        await db.collection('settings').doc('gloryServiceVideo').set({
          url: videoUrl,
          updatedAt: firebase.firestore.FieldValue.serverTimestamp()
        });
        showToast('‚úÖ Glory Service video saved!', 'success');
        loadHomepageSettings();
      } catch (error) { showToast('‚ùå Failed to save: ' + error.message, 'error'); }
    }

    // Save footer images
    async function saveFooterImages() {
      if (!isAdmin) { showToast('‚ùå Admin access required', 'error'); return; }
      const img1 = document.getElementById('footerImage1').value.trim();
      const img2 = document.getElementById('footerImage2').value.trim();
      try {
        await db.collection('settings').doc('footerImages').set({
          image1: img1,
          image2: img2,
          updatedAt: firebase.firestore.FieldValue.serverTimestamp()
        });
        showToast('‚úÖ Footer images saved!', 'success');
        loadHomepageSettings();
      } catch (error) { showToast('‚ùå Failed to save: ' + error.message, 'error'); }
    }

    // Save Tuesday Counselling video
    async function saveTuesdayCounsellingVideo() {
      if (!isAdmin) { showToast('‚ùå Admin access required', 'error'); return; }
      const videoUrl = document.getElementById('tuesdayCounsellingVideo').value.trim();
      try {
        await db.collection('settings').doc('tuesdayCounsellingVideo').set({
          url: videoUrl,
          updatedAt: firebase.firestore.FieldValue.serverTimestamp()
        });
        showToast('‚úÖ Tuesday Counselling video saved!', 'success');
        loadHomepageSettings();
      } catch (error) { showToast('‚ùå Failed to save: ' + error.message, 'error'); }
    }

    // Save Fire Night settings
    async function saveFireNightSettings() {
      if (!isAdmin) { showToast('‚ùå Admin access required', 'error'); return; }
      const dateVal = document.getElementById('fireNightDate').value;
      const timeVal = document.getElementById('fireNightTime').value || '22:00';
      if (!dateVal) {
        showToast('‚ö†Ô∏è Please select a date for Fire Night', 'error');
        return;
      }
      try {
        await db.collection('settings').doc('fireNight').set({
          customDate: dateVal,
          customTime: timeVal,
          updatedAt: firebase.firestore.FieldValue.serverTimestamp()
        });
        showToast('‚úÖ Fire Night settings saved!', 'success');
        loadHomepageSettings();
      } catch (error) { showToast('‚ùå Failed to save: ' + error.message, 'error'); }
    }

    // Clear Fire Night settings (reset to automatic)
    async function clearFireNightSettings() {
      if (!isAdmin) { showToast('‚ùå Admin access required', 'error'); return; }
      try {
        await db.collection('settings').doc('fireNight').delete();
        document.getElementById('fireNightDate').value = '';
        document.getElementById('fireNightTime').value = '22:00';
        customFireNightDate = null;
        showToast('‚úÖ Fire Night reset to automatic (last Friday of month)', 'success');
        updateCountdown();
      } catch (error) { showToast('‚ùå Failed to reset: ' + error.message, 'error'); }
    }

    // Custom Fire Night date storage
    let customFireNightDate = null;

    // Load homepage settings (hero, video, footer)
    async function loadHomepageSettings() {
      try {
        // Load hero images
        const heroDoc = await db.collection('settings').doc('heroImages').get();
        if (heroDoc.exists && heroDoc.data().images?.length > 0) {
          heroBackgrounds.length = 0;
          heroDoc.data().images.forEach(url => { if(url) heroBackgrounds.push(url); });
          const heroSection = document.getElementById('heroSection');
          if (heroSection && heroBackgrounds.length > 0) {
            heroSection.style.backgroundImage = `url('${heroBackgrounds[0]}')`;
            heroSection.style.backgroundSize = 'cover';
            heroSection.style.backgroundPosition = 'center';
          }
          // Populate admin fields
          if (document.getElementById('heroImage1')) {
            document.getElementById('heroImage1').value = heroDoc.data().images[0] || '';
            document.getElementById('heroImage2').value = heroDoc.data().images[1] || '';
            document.getElementById('heroImage3').value = heroDoc.data().images[2] || '';
          }
        }

        // Load Glory Service video
        const videoDoc = await db.collection('settings').doc('gloryServiceVideo').get();
        const videoSection = document.getElementById('gloryServiceVideoSection');
        const videoFrame = document.getElementById('gloryServiceVideoFrame');
        if (videoDoc.exists && videoDoc.data().url) {
          videoFrame.src = videoDoc.data().url;
          videoSection.style.display = 'block';
          if (document.getElementById('gloryServiceVideo')) {
            document.getElementById('gloryServiceVideo').value = videoDoc.data().url;
          }
        } else {
          videoSection.style.display = 'none';
        }

        // Load Tuesday Counselling video
        const tuesdayVideoDoc = await db.collection('settings').doc('tuesdayCounsellingVideo').get();
        const tuesdayVideoSection = document.getElementById('tuesdayCounsellingVideoSection');
        const tuesdayVideoFrame = document.getElementById('tuesdayCounsellingVideoFrame');
        if (tuesdayVideoDoc.exists && tuesdayVideoDoc.data().url) {
          tuesdayVideoFrame.src = tuesdayVideoDoc.data().url;
          tuesdayVideoSection.style.display = 'block';
          if (document.getElementById('tuesdayCounsellingVideo')) {
            document.getElementById('tuesdayCounsellingVideo').value = tuesdayVideoDoc.data().url;
          }
        } else {
          tuesdayVideoSection.style.display = 'none';
        }

        // Load Fire Night settings
        const fireNightDoc = await db.collection('settings').doc('fireNight').get();
        if (fireNightDoc.exists && fireNightDoc.data().customDate) {
          const data = fireNightDoc.data();
          const [year, month, day] = data.customDate.split('-').map(Number);
          const [hours, minutes] = (data.customTime || '22:00').split(':').map(Number);
          customFireNightDate = new Date(year, month - 1, day, hours, minutes, 0, 0);
          if (document.getElementById('fireNightDate')) {
            document.getElementById('fireNightDate').value = data.customDate;
            document.getElementById('fireNightTime').value = data.customTime || '22:00';
          }
          updateCountdown();
        } else {
          customFireNightDate = null;
        }

        // Load footer images
        const footerDoc = await db.collection('settings').doc('footerImages').get();
        if (footerDoc.exists) {
          const data = footerDoc.data();
          if (data.image1) document.getElementById('footerImg1').src = data.image1;
          if (data.image2) document.getElementById('footerImg2').src = data.image2;
          if (document.getElementById('footerImage1')) {
            document.getElementById('footerImage1').value = data.image1 || '';
            document.getElementById('footerImage2').value = data.image2 || '';
          }
        }
      } catch (error) { console.error('Error loading homepage settings:', error); }
    }

    // Load live stream URLs and content when page loads
    window.addEventListener('DOMContentLoaded', function() {
      loadSavedLiveStreamUrls();
      updateLiveStatusDisplay();
      updateLogoDisplay();
      updateSocialLinks();
      loadAboutContent();
      loadUpcomingEvents();
      loadHomepageSettings();
      loadGivingSettings();
      loadContactInfo();
      if (isAdmin) {
        loadPrayerRequests();
      }
      
      // Set initial hero background
      const heroSection = document.getElementById('heroSection');
      if (heroSection) {
        heroSection.style.backgroundImage = `url('https://lh3.googleusercontent.com/d/1exCpQcpobaYeFM3LJx8EwrdCPYbmy_wy')`;
        heroSection.style.backgroundSize = 'cover';
        heroSection.style.backgroundPosition = 'center';
      }
      
      // Initialize and update countdown every second
      updateCountdown();
      setInterval(updateCountdown, 1000);
      
      // Rotate hero background every 20 seconds
      setInterval(rotateHeroBackground, 20000);
      
      // Check live status every 10 seconds for real-time updates
      setInterval(updateLiveStatusDisplay, 10000);
    });
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9a728c9e06bd534c',t:'MTc2NDU5MTczOC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>











